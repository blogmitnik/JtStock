/*! Scroller 1.4.0
 * Â©2011-2015 SpryMedia Ltd - datatables.net/license
 */
/**
 * @summary     Scroller
 * @description Virtual rendering for DataTables
 * @version     1.4.0
 * @file        dataTables.scroller.js
 * @author      SpryMedia Ltd (www.sprymedia.co.uk)
 * @contact     www.sprymedia.co.uk/contact
 * @copyright   Copyright 2011-2015 SpryMedia Ltd.
 *
 * This source file is free software, available under the following license:
 *   MIT license - http://datatables.net/license/mit
 *
 * This source file is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 * or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.
 *
 * For details please refer to: http://www.datatables.net
 */
!function(A){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(t){return A(t,window,document)}):"object"==typeof exports?module.exports=function(t,e){return t||(t=window),e&&e.fn.dataTable||(e=require("datatables.net")(t,e).$),A(e,t,t.document)}:A(jQuery,window,document)}(function(A,t,e,i){"use strict";var n=A.fn.dataTable,o=function(t,n){return this instanceof o?(n===i&&(n={}),this.s={dt:A.fn.dataTable.Api(t).settings()[0],tableTop:0,tableBottom:0,redrawTop:0,redrawBottom:0,autoHeight:!0,viewportRows:0,stateTO:null,drawTO:null,heights:{jump:null,page:null,virtual:null,scroll:null,row:null,viewport:null},topRowFloat:0,scrollDrawDiff:null,loaderVisible:!1},this.s=A.extend(this.s,o.oDefaults,n),this.s.heights.row=this.s.rowHeight,this.dom={force:e.createElement("div"),scroller:null,table:null,loader:null},void(this.s.dt.oScroller||(this.s.dt.oScroller=this,this._fnConstruct()))):void alert("Scroller warning: Scroller must be initialised with the 'new' keyword.")};A.extend(o.prototype,{fnRowToPixels:function(A,t,e){var n;if(e)n=this._domain("virtualToPhysical",A*this.s.heights.row);else{var o=A-this.s.baseRowTop;n=this.s.baseScrollTop+o*this.s.heights.row}return t||t===i?parseInt(n,10):n},fnPixelsToRow:function(A,t,e){var n=A-this.s.baseScrollTop,o=e?this._domain("physicalToVirtual",A)/this.s.heights.row:n/this.s.heights.row+this.s.baseRowTop;return t||t===i?parseInt(o,10):o},fnScrollToRow:function(t,e){var i=this,n=!1,o=this.fnRowToPixels(t),r=(this.s.displayBuffer-1)/2*this.s.viewportRows,s=t-r;0>s&&(s=0),(o>this.s.redrawBottom||o<this.s.redrawTop)&&this.s.dt._iDisplayStart!==s&&(n=!0,o=this.fnRowToPixels(t,!1,!0)),"undefined"==typeof e||e?(this.s.ani=n,A(this.dom.scroller).animate({scrollTop:o},function(){setTimeout(function(){i.s.ani=!1},25)})):A(this.dom.scroller).scrollTop(o)},fnMeasure:function(t){this.s.autoHeight&&this._fnCalcRowHeight();var e=this.s.heights;e.viewport=A(this.dom.scroller).height(),this.s.viewportRows=parseInt(e.viewport/e.row,10)+1,this.s.dt._iDisplayLength=this.s.viewportRows*this.s.displayBuffer,(t===i||t)&&this.s.dt.oInstance.fnDraw(!1)},_fnConstruct:function(){var e=this;if(!this.s.dt.oFeatures.bPaginate)return void this.s.dt.oApi._fnLog(this.s.dt,0,"Pagination must be enabled for Scroller");this.dom.force.style.position="relative",this.dom.force.style.top="0px",this.dom.force.style.left="0px",this.dom.force.style.width="1px",this.dom.scroller=A("div."+this.s.dt.oClasses.sScrollBody,this.s.dt.nTableWrapper)[0],this.dom.scroller.appendChild(this.dom.force),this.dom.scroller.style.position="relative",this.dom.table=A(">table",this.dom.scroller)[0],this.dom.table.style.position="absolute",this.dom.table.style.top="0px",this.dom.table.style.left="0px",A(this.s.dt.nTableWrapper).addClass("DTS"),this.s.loadingIndicator&&(this.dom.loader=A('<div class="dataTables_processing DTS_Loading">'+this.s.dt.oLanguage.sLoadingRecords+"</div>").css("display","none"),A(this.dom.scroller.parentNode).css("position","relative").append(this.dom.loader)),this.s.heights.row&&"auto"!=this.s.heights.row&&(this.s.autoHeight=!1),this.fnMeasure(!1),this.s.ingnoreScroll=!0,this.s.stateSaveThrottle=this.s.dt.oApi._fnThrottle(function(){e.s.dt.oApi._fnSaveState(e.s.dt)},500),A(this.dom.scroller).on("scroll.DTS",function(){e._fnScroll.call(e)}),A(this.dom.scroller).on("touchstart.DTS",function(){e._fnScroll.call(e)}),this.s.dt.aoDrawCallback.push({fn:function(){e.s.dt.bInitialised&&e._fnDrawCallback.call(e)},sName:"Scroller"}),A(t).on("resize.DTS",function(){e.fnMeasure(!1),e._fnInfo()});var i=!0;this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(A,t){i&&e.s.dt.oLoadedState?(t.iScroller=e.s.dt.oLoadedState.iScroller,t.iScrollerTopRow=e.s.dt.oLoadedState.iScrollerTopRow,i=!1):(t.iScroller=e.dom.scroller.scrollTop,t.iScrollerTopRow=e.s.topRowFloat)},"Scroller_State"),this.s.dt.oLoadedState&&(this.s.topRowFloat=this.s.dt.oLoadedState.iScrollerTopRow||0),A(this.s.dt.nTable).on("init.dt",function(){e.fnMeasure()}),this.s.dt.aoDestroyCallback.push({sName:"Scroller",fn:function(){A(t).off("resize.DTS"),A(e.dom.scroller).off("touchstart.DTS scroll.DTS"),A(e.s.dt.nTableWrapper).removeClass("DTS"),A("div.DTS_Loading",e.dom.scroller.parentNode).remove(),A(e.s.dt.nTable).off("init.dt"),e.dom.table.style.position="",e.dom.table.style.top="",e.dom.table.style.left=""}})},_fnScroll:function(){var t,e=this,i=this.s.heights,n=this.dom.scroller.scrollTop;if(!this.s.skip&&!this.s.ingnoreScroll){if(this.s.dt.bFiltered||this.s.dt.bSorted)return void(this.s.lastScrollTop=0);if(this._fnInfo(),clearTimeout(this.s.stateTO),this.s.stateTO=setTimeout(function(){e.s.dt.oApi._fnSaveState(e.s.dt)},250),n<this.s.redrawTop||n>this.s.redrawBottom){var o=Math.ceil((this.s.displayBuffer-1)/2*this.s.viewportRows);if(Math.abs(n-this.s.lastScrollTop)>i.viewport||this.s.ani?(t=parseInt(this._domain("physicalToVirtual",n)/i.row,10)-o,this.s.topRowFloat=this._domain("physicalToVirtual",n)/i.row):(t=this.fnPixelsToRow(n)-o,this.s.topRowFloat=this.fnPixelsToRow(n,!1)),0>=t?t=0:t+this.s.dt._iDisplayLength>this.s.dt.fnRecordsDisplay()?(t=this.s.dt.fnRecordsDisplay()-this.s.dt._iDisplayLength,0>t&&(t=0)):t%2!==0&&t++,t!=this.s.dt._iDisplayStart){this.s.tableTop=A(this.s.dt.nTable).offset().top,this.s.tableBottom=A(this.s.dt.nTable).height()+this.s.tableTop;var r=function(){null===e.s.scrollDrawReq&&(e.s.scrollDrawReq=n),e.s.dt._iDisplayStart=t,e.s.dt.oApi._fnDraw(e.s.dt)};this.s.dt.oFeatures.bServerSide?(clearTimeout(this.s.drawTO),this.s.drawTO=setTimeout(r,this.s.serverWait)):r(),this.dom.loader&&!this.s.loaderVisible&&(this.dom.loader.css("display","block"),this.s.loaderVisible=!0)}}this.s.lastScrollTop=n,this.s.stateSaveThrottle()}},_domain:function(A,t){var e,i=this.s.heights;if(i.virtual===i.scroll)return t;var n=(i.scroll-i.viewport)/2,o=(i.virtual-i.viewport)/2;return e=o/(n*n),"virtualToPhysical"===A?o>t?Math.pow(t/e,.5):(t=2*o-t,0>t?i.scroll:2*n-Math.pow(t/e,.5)):"physicalToVirtual"===A?n>t?t*t*e:(t=2*n-t,0>t?i.virtual:2*o-t*t*e):void 0},_fnDrawCallback:function(){var t=this,e=this.s.heights,i=this.dom.scroller.scrollTop,n=(i+e.viewport,A(this.s.dt.nTable).height()),o=this.s.dt._iDisplayStart,r=this.s.dt._iDisplayLength,s=this.s.dt.fnRecordsDisplay();this.s.skip=!0,this._fnScrollForce(),i=0===o?this.s.topRowFloat*e.row:o+r>=s?e.scroll-(s-this.s.topRowFloat)*e.row:this._domain("virtualToPhysical",this.s.topRowFloat*e.row),this.dom.scroller.scrollTop=i,this.s.baseScrollTop=i,this.s.baseRowTop=this.s.topRowFloat;var a=i-(this.s.topRowFloat-o)*e.row;0===o?a=0:o+r>=s&&(a=e.scroll-n),this.dom.table.style.top=a+"px",this.s.tableTop=a,this.s.tableBottom=n+this.s.tableTop;var l=(i-this.s.tableTop)*this.s.boundaryScale;if(this.s.redrawTop=i-l,this.s.redrawBottom=i+l,this.s.skip=!1,this.s.dt.oFeatures.bStateSave&&null!==this.s.dt.oLoadedState&&"undefined"!=typeof this.s.dt.oLoadedState.iScroller){var c=(this.s.dt.sAjaxSource||t.s.dt.ajax)&&!this.s.dt.oFeatures.bServerSide;(c&&2==this.s.dt.iDraw||!c&&1==this.s.dt.iDraw)&&setTimeout(function(){A(t.dom.scroller).scrollTop(t.s.dt.oLoadedState.iScroller),t.s.redrawTop=t.s.dt.oLoadedState.iScroller-e.viewport/2,setTimeout(function(){t.s.ingnoreScroll=!1},0)},0)}else t.s.ingnoreScroll=!1;setTimeout(function(){t._fnInfo.call(t)},0),this.dom.loader&&this.s.loaderVisible&&(this.dom.loader.css("display","none"),this.s.loaderVisible=!1)},_fnScrollForce:function(){var A=this.s.heights,t=1e6;A.virtual=A.row*this.s.dt.fnRecordsDisplay(),A.scroll=A.virtual,A.scroll>t&&(A.scroll=t),this.dom.force.style.height=A.scroll>this.s.heights.row?A.scroll+"px":this.s.heights.row+"px"},_fnCalcRowHeight:function(){var t=this.s.dt,e=t.nTable,i=e.cloneNode(!1),n=A("<tbody/>").appendTo(i),o=A('<div class="'+t.oClasses.sWrapper+' DTS"><div class="'+t.oClasses.sScrollWrapper+'"><div class="'+t.oClasses.sScrollBody+'"></div></div></div>');for(A("tbody tr:lt(4)",e).clone().appendTo(n);A("tr",n).length<3;)n.append("<tr><td>&nbsp;</td></tr>");A("div."+t.oClasses.sScrollBody,o).append(i),o.appendTo(this.s.dt.nHolding||e.parentNode),this.s.heights.row=A("tr",n).eq(1).outerHeight(),o.remove()},_fnInfo:function(){if(this.s.dt.oFeatures.bInfo){var t,e=this.s.dt,i=e.oLanguage,n=this.dom.scroller.scrollTop,o=Math.floor(this.fnPixelsToRow(n,!1,this.s.ani)+1),r=e.fnRecordsTotal(),s=e.fnRecordsDisplay(),a=Math.ceil(this.fnPixelsToRow(n+this.s.heights.viewport,!1,this.s.ani)),l=a>s?s:a,c=e.fnFormatNumber(o),h=e.fnFormatNumber(l),u=e.fnFormatNumber(r),d=e.fnFormatNumber(s);t=0===e.fnRecordsDisplay()&&e.fnRecordsDisplay()==e.fnRecordsTotal()?i.sInfoEmpty+i.sInfoPostFix:0===e.fnRecordsDisplay()?i.sInfoEmpty+" "+i.sInfoFiltered.replace("_MAX_",u)+i.sInfoPostFix:e.fnRecordsDisplay()==e.fnRecordsTotal()?i.sInfo.replace("_START_",c).replace("_END_",h).replace("_MAX_",u).replace("_TOTAL_",d)+i.sInfoPostFix:i.sInfo.replace("_START_",c).replace("_END_",h).replace("_MAX_",u).replace("_TOTAL_",d)+" "+i.sInfoFiltered.replace("_MAX_",e.fnFormatNumber(e.fnRecordsTotal()))+i.sInfoPostFix;var f=i.fnInfoCallback;f&&(t=f.call(e.oInstance,e,o,l,r,s,t));var g=e.aanFeatures.i;if("undefined"!=typeof g)for(var p=0,B=g.length;B>p;p++)A(g[p]).html(t)}}}),o.defaults={trace:!1,rowHeight:"auto",serverWait:200,displayBuffer:9,boundaryScale:.5,loadingIndicator:!1},o.oDefaults=o.defaults,o.version="1.4.0","function"==typeof A.fn.dataTable&&"function"==typeof A.fn.dataTableExt.fnVersionCheck&&A.fn.dataTableExt.fnVersionCheck("1.10.0")?A.fn.dataTableExt.aoFeatures.push({fnInit:function(A){var t=A.oInit,e=t.scroller||t.oScroller||{};new o(A,e)},cFeature:"S",sFeature:"Scroller"}):alert("Warning: Scroller requires DataTables 1.10.0 or greater - www.datatables.net/download"),A(e).on("preInit.dt.dtscroller",function(t,e){if("dt"===t.namespace){var i=e.oInit.scroller,r=n.defaults.scroller;if(i||r){var s=A.extend({},i,r);i!==!1&&new o(e,s)}}}),A.fn.dataTable.Scroller=o,A.fn.DataTable.Scroller=o;var r=A.fn.dataTable.Api;return r.register("scroller()",function(){return this}),r.register("scroller().rowToPixels()",function(A,t,e){var i=this.context;return i.length&&i[0].oScroller?i[0].oScroller.fnRowToPixels(A,t,e):void 0}),r.register("scroller().pixelsToRow()",function(A,t,e){var i=this.context;return i.length&&i[0].oScroller?i[0].oScroller.fnPixelsToRow(A,t,e):void 0}),r.register("scroller().scrollToRow()",function(A,t){return this.iterator("table",function(e){e.oScroller&&e.oScroller.fnScrollToRow(A,t)}),this}),r.register("row().scrollTo()",function(A){var t=this;return this.iterator("row",function(e,i){if(e.oScroller){var n=t.rows({order:"applied",search:"applied"}).indexes().indexOf(i);e.oScroller.fnScrollToRow(n,A)}}),this}),r.register("scroller.measure()",function(A){return this.iterator("table",function(t){t.oScroller&&t.oScroller.fnMeasure(A)}),this}),o});