/*! Select for DataTables 1.1.0
 * 2015 SpryMedia Ltd - datatables.net/license/mit
 */
/**
 * @summary     Select for DataTables
 * @description A collection of API methods, events and buttons for DataTables
 *   that provides selection options of the items in a DataTable
 * @version     1.1.0
 * @file        dataTables.select.js
 * @author      SpryMedia Ltd (www.sprymedia.co.uk)
 * @contact     datatables.net/forums
 * @copyright   Copyright 2015 SpryMedia Ltd.
 *
 * This source file is free software, available under the following license:
 *   MIT license - http://datatables.net/license/mit
 *
 * This source file is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 * or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.
 *
 * For details please refer to: http://www.datatables.net/extensions/select
 */
!function(A){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(t){return A(t,window,document)}):"object"==typeof exports?module.exports=function(t,e){return t||(t=window),e&&e.fn.dataTable||(e=require("datatables.net")(t,e).$),A(e,t,t.document)}:A(jQuery,window,document)}(function(A,t,e,i){"use strict";function n(A,t,e){var i,n,o,r=function(t,e){if(t>e){var i=e;e=t,t=i}var n=!1;return A.columns(":visible").indexes().filter(function(A){return A===t&&(n=!0),A===e?(n=!1,!0):n})},s=function(t,e){var i=A.rows({search:"applied"}).indexes();if(i.indexOf(t)>i.indexOf(e)){var n=e;e=t,t=n}var o=!1;return i.filter(function(A){return A===t&&(o=!0),A===e?(o=!1,!0):o})};A.cells({selected:!0}).any()||e?(n=r(e.column,t.column),o=s(e.row,t.row)):(n=r(0,t.column),o=s(0,t.row)),i=A.cells(o,n).flatten(),A.cells(t,{selected:!0}).any()?A.cells(i).deselect():A.cells(i).select()}function o(t){var e=t.settings()[0],i=e._select.selector;A(t.table().body()).off("mousedown.dtSelect",i).off("mouseup.dtSelect",i).off("click.dtSelect",i),A("body").off("click.dtSelect")}function r(t){var e=A(t.table().body()),i=t.settings()[0],n=i._select.selector;e.on("mousedown.dtSelect",n,function(A){A.shiftKey&&e.css("-moz-user-select","none").one("selectstart.dtSelect",n,function(){return!1})}).on("mouseup.dtSelect",n,function(){e.css("-moz-user-select","")}).on("click.dtSelect",n,function(i){var n,o=t.select.items(),r=t.settings()[0];if(A(i.target).closest("tbody")[0]==e[0]){var s=A(i.target).closest("td, th"),a=t.cell(s).index();t.cell(s).any()&&("row"===o?(n=a.row,u(i,t,r,"row",n)):"column"===o?(n=t.cell(s).index().column,u(i,t,r,"column",n)):"cell"===o&&(n=t.cell(s).index(),u(i,t,r,"cell",n)),r._select_lastCell=a)}}),A("body").on("click.dtSelect",function(e){if(i._select.blurable){if(A(e.target).parents().filter(t.table().container()).length)return;if(A(e.target).parents("div.DTE").length)return;h(i,!0)}})}function s(t,e,i,n){n&&!t.flatten().length||(i.unshift(t),A(t.table().node()).triggerHandler(e+".dt",i))}function a(t){var e=t.settings()[0];if(e._select.info&&e.aanFeatures.i){var i=A('<span class="select-info"/>'),n=function(e,n){i.append(A('<span class="select-item"/>').append(t.i18n("select."+e+"s",{_:"%d "+e+"s selected",0:"",1:"1 "+e+" selected"},n)))};n("row",t.rows({selected:!0}).flatten().length),n("column",t.columns({selected:!0}).flatten().length),n("cell",t.cells({selected:!0}).flatten().length),A.each(e.aanFeatures.i,function(t,e){e=A(e);var n=e.children("span.select-info");n.length&&n.remove(),""!==i.text()&&e.append(i)})}}function l(t){var e=new f.Api(t);t.aoRowCreatedCallback.push({fn:function(e,i,n){var o,r,s=t.aoData[n];for(s._select_selected&&A(e).addClass(t._select.className),o=0,r=t.aoColumns.length;r>o;o++)(t.aoColumns[o]._select_selected||s._selected_cells&&s._selected_cells[o])&&A(s.anCells[o]).addClass(t._select.className)},sName:"select-deferRender"}),e.on("preXhr.dt.dtSelect",function(){var A=e.rows({selected:!0}).ids(!0).filter(function(A){return A!==i}),t=e.cells({selected:!0}).eq(0).map(function(A){var t=e.row(A.row).id(!0);return t?{row:t,column:A.column}:i}).filter(function(A){return A!==i});e.one("draw.dt.dtSelect",function(){e.rows(A).select(),t.any()&&t.each(function(A){e.cells(A.row,A.column).select()})})}),e.on("draw.dtSelect.dt select.dtSelect.dt deselect.dtSelect.dt",function(){a(e)}),e.on("destroy.dtSelect",function(){o(e),e.off(".dtSelect")})}function c(t,e,i,n){var o=t[e+"s"]({search:"applied"}).indexes(),r=A.inArray(n,o),s=A.inArray(i,o);if(t[e+"s"]({selected:!0}).any()||-1!==r){if(r>s){var a=s;s=r,r=a}o.splice(s+1,o.length),o.splice(0,r)}else o.splice(A.inArray(i,o)+1,o.length);t[e](i,{selected:!0}).any()?(o.splice(A.inArray(i,o),1),t[e+"s"](o).deselect()):t[e+"s"](o).select()}function h(A,t){if(t||"single"===A._select.style){var e=new f.Api(A);e.rows({selected:!0}).deselect(),e.columns({selected:!0}).deselect(),e.cells({selected:!0}).deselect()}}function u(A,t,e,i,o){var r=t.select.style(),s=t[i](o,{selected:!0}).any();if("os"===r)if(A.ctrlKey||A.metaKey)t[i](o).select(!s);else if(A.shiftKey)"cell"===i?n(t,o,e._select_lastCell||null):c(t,i,o,e._select_lastCell?e._select_lastCell[i]:null);else{var a=t[i+"s"]({selected:!0});s&&1===a.flatten().length?t[i](o).deselect():(a.deselect(),t[i](o).select())}else t[i](o).select(!s)}function d(A,t){return function(e){return e.i18n("buttons."+A,t)}}var f=A.fn.dataTable;f.select={},f.select.version="1.1.0",A.each([{type:"row",prop:"aoData"},{type:"column",prop:"aoColumns"}],function(A,t){f.ext.selector[t.type].push(function(A,e,n){var o,r=e.selected,s=[];if(r===i)return n;for(var a=0,l=n.length;l>a;a++)o=A[t.prop][n[a]],(r===!0&&o._select_selected===!0||r===!1&&!o._select_selected)&&s.push(n[a]);return s})}),f.ext.selector.cell.push(function(A,t,e){var n,o=t.selected,r=[];if(o===i)return e;for(var s=0,a=e.length;a>s;s++)n=A.aoData[e[s].row],(o===!0&&n._selected_cells&&n._selected_cells[e[s].column]===!0||o===!1&&(!n._selected_cells||!n._selected_cells[e[s].column]))&&r.push(e[s]);return r});var g=f.Api.register,p=f.Api.registerPlural;return g("select()",function(){}),g("select.blurable()",function(A){return A===i?this.context[0]._select.blurable:this.iterator("table",function(t){t._select.blurable=A})}),g("select.info()",function(A){return a===i?this.context[0]._select.info:this.iterator("table",function(t){t._select.info=A})}),g("select.items()",function(A){return A===i?this.context[0]._select.items:this.iterator("table",function(t){t._select.items=A,s(new f.Api(t),"selectItems",[A])})}),g("select.style()",function(A){return A===i?this.context[0]._select.style:this.iterator("table",function(t){t._select.style=A,t._select_init||l(t);var e=new f.Api(t);o(e),"api"!==A&&r(e),s(new f.Api(t),"selectStyle",[A])})}),g("select.selector()",function(A){return A===i?this.context[0]._select.selector:this.iterator("table",function(t){o(new f.Api(t)),t._select.selector=A,"api"!==t._select.style&&r(new f.Api(t))})}),p("rows().select()","row().select()",function(t){var e=this;return t===!1?this.deselect():(this.iterator("row",function(t,e){h(t),t.aoData[e]._select_selected=!0,A(t.aoData[e].nTr).addClass(t._select.className)}),this.iterator("table",function(A,t){s(e,"select",["row",e[t]],!0)}),this)}),p("columns().select()","column().select()",function(t){var e=this;return t===!1?this.deselect():(this.iterator("column",function(t,e){h(t),t.aoColumns[e]._select_selected=!0;var i=new f.Api(t).column(e);A(i.header()).addClass(t._select.className),A(i.footer()).addClass(t._select.className),i.nodes().to$().addClass(t._select.className)}),this.iterator("table",function(A,t){s(e,"select",["column",e[t]],!0)}),this)}),p("cells().select()","cell().select()",function(t){var e=this;return t===!1?this.deselect():(this.iterator("cell",function(t,e,n){h(t);var o=t.aoData[e];o._selected_cells===i&&(o._selected_cells=[]),o._selected_cells[n]=!0,o.anCells&&A(o.anCells[n]).addClass(t._select.className)}),this.iterator("table",function(A,t){s(e,"select",["cell",e[t]],!0)}),this)}),p("rows().deselect()","row().deselect()",function(){var t=this;return this.iterator("row",function(t,e){t.aoData[e]._select_selected=!1,A(t.aoData[e].nTr).removeClass(t._select.className)}),this.iterator("table",function(A,e){s(t,"deselect",["row",t[e]],!0)}),this}),p("columns().deselect()","column().deselect()",function(){var t=this;return this.iterator("column",function(t,e){t.aoColumns[e]._select_selected=!1;var i=new f.Api(t),n=i.column(e);A(n.header()).removeClass(t._select.className),A(n.footer()).removeClass(t._select.className),i.cells(null,e).indexes().each(function(e){var i=t.aoData[e.row],n=i._selected_cells;!i.anCells||n&&n[e.column]||A(i.anCells[e.column]).removeClass(t._select.className)})}),this.iterator("table",function(A,e){s(t,"deselect",["column",t[e]],!0)}),this}),p("cells().deselect()","cell().deselect()",function(){var t=this;return this.iterator("cell",function(t,e,i){var n=t.aoData[e];n._selected_cells[i]=!1,n.anCells&&!t.aoColumns[i]._select_selected&&A(n.anCells[i]).removeClass(t._select.className)}),this.iterator("table",function(A,e){s(t,"deselect",["cell",t[e]],!0)}),this}),A.extend(f.ext.buttons,{selected:{text:d("selected","Selected"),className:"buttons-selected",init:function(A){var t=this;A.on("draw.dt.DT select.dt.DT deselect.dt.DT",function(){var A=t.rows({selected:!0}).any()||t.columns({selected:!0}).any()||t.cells({selected:!0}).any();t.enable(A)}),this.disable()}},selectedSingle:{text:d("selectedSingle","Selected single"),className:"buttons-selected-single",init:function(A){var t=this;A.on("draw.dt.DT select.dt.DT deselect.dt.DT",function(){var e=A.rows({selected:!0}).flatten().length+A.columns({selected:!0}).flatten().length+A.cells({selected:!0}).flatten().length;t.enable(1===e)}),this.disable()}},selectAll:{text:d("selectAll","Select all"),className:"buttons-select-all",action:function(){var A=this.select.items();this[A+"s"]().select()}},selectNone:{text:d("selectNone","Deselect all"),className:"buttons-select-none",action:function(){h(this.settings()[0],!0)}}}),A.each(["Row","Column","Cell"],function(A,t){var e=t.toLowerCase();f.ext.buttons["select"+t+"s"]={text:d("select"+t+"s","Select "+e+"s"),className:"buttons-select-"+e+"s",action:function(){this.select.items(e)},init:function(A){var t=this;A.on("selectItems.dt.DT",function(A,i,n){t.active(n===e)})}}}),A(e).on("preInit.dt.dtSelect",function(t,e){if("dt"===t.namespace){var n=e.oInit.select||f.defaults.select,o=new f.Api(e),r="row",s="api",a=!1,l=!0,c="td, th",h="selected";e._select={},n===!0?s="os":"string"==typeof n?s=n:A.isPlainObject(n)&&(n.blurable!==i&&(a=n.blurable),n.info!==i&&(l=n.info),n.items!==i&&(r=n.items),n.style!==i&&(s=n.style),n.selector!==i&&(c=n.selector),n.className!==i&&(h=n.className)),o.select.selector(c),o.select.items(r),o.select.style(s),o.select.blurable(a),o.select.info(l),e._select.className=h,A(o.table().node()).hasClass("selectable")&&o.select.style("os")}}),f.select});