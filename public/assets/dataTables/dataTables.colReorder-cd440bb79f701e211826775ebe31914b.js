/*! ColReorder 1.3.0
 * Â©2010-2015 SpryMedia Ltd - datatables.net/license
 */
/**
 * @summary     ColReorder
 * @description Provide the ability to reorder columns in a DataTable
 * @version     1.3.0
 * @file        dataTables.colReorder.js
 * @author      SpryMedia Ltd (www.sprymedia.co.uk)
 * @contact     www.sprymedia.co.uk/contact
 * @copyright   Copyright 2010-2014 SpryMedia Ltd.
 *
 * This source file is free software, available under the following license:
 *   MIT license - http://datatables.net/license/mit
 *
 * This source file is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 * or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.
 *
 * For details please refer to: http://www.datatables.net
 */
!function(A){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(t){return A(t,window,document)}):"object"==typeof exports?module.exports=function(t,e){return t||(t=window),e&&e.fn.dataTable||(e=require("datatables.net")(t,e).$),A(e,t,t.document)}:A(jQuery,window,document)}(function(A,t,e,i){"use strict";function n(A){for(var t=[],e=0,i=A.length;i>e;e++)t[A[e]]=e;return t}function r(A,t,e){var i=A.splice(t,1)[0];A.splice(e,0,i)}function o(A,t,e){for(var i=[],n=0,r=A.childNodes.length;r>n;n++)1==A.childNodes[n].nodeType&&i.push(A.childNodes[n]);var o=i[t];null!==e?A.insertBefore(o,i[e]):A.appendChild(o)}var s=A.fn.dataTable;A.fn.dataTableExt.oApi.fnColReorder=function(t,e,i,s){var a,l,c,h,u,d,f=t.aoColumns.length,g=function(A,t,e){if(A[t]&&"function"!=typeof A[t]){var i=A[t].split("."),n=i.shift();isNaN(1*n)||(A[t]=e[1*n]+"."+i.join("."))}};if(e!=i){if(0>e||e>=f)return void this.oApi._fnLog(t,1,"ColReorder 'from' index is out of bounds: "+e);if(0>i||i>=f)return void this.oApi._fnLog(t,1,"ColReorder 'to' index is out of bounds: "+i);var p=[];for(a=0,l=f;l>a;a++)p[a]=a;r(p,e,i);var B=n(p);for(a=0,l=t.aaSorting.length;l>a;a++)t.aaSorting[a][0]=B[t.aaSorting[a][0]];if(null!==t.aaSortingFixed)for(a=0,l=t.aaSortingFixed.length;l>a;a++)t.aaSortingFixed[a][0]=B[t.aaSortingFixed[a][0]];for(a=0,l=f;l>a;a++){for(d=t.aoColumns[a],c=0,h=d.aDataSort.length;h>c;c++)d.aDataSort[c]=B[d.aDataSort[c]];d.idx=B[d.idx]}for(A.each(t.aLastSort,function(A,e){t.aLastSort[A].src=B[e.src]}),a=0,l=f;l>a;a++)d=t.aoColumns[a],"number"==typeof d.mData?(d.mData=B[d.mData],t.oApi._fnColumnOptions(t,a,{})):A.isPlainObject(d.mData)&&(g(d.mData,"_",B),g(d.mData,"filter",B),g(d.mData,"sort",B),g(d.mData,"type",B),t.oApi._fnColumnOptions(t,a,{}));if(t.aoColumns[e].bVisible){var w=this.oApi._fnColumnIndexToVisible(t,e),m=null;for(a=e>i?i:i+1;null===m&&f>a;)m=this.oApi._fnColumnIndexToVisible(t,a),a++;for(u=t.nTHead.getElementsByTagName("tr"),a=0,l=u.length;l>a;a++)o(u[a],w,m);if(null!==t.nTFoot)for(u=t.nTFoot.getElementsByTagName("tr"),a=0,l=u.length;l>a;a++)o(u[a],w,m);for(a=0,l=t.aoData.length;l>a;a++)null!==t.aoData[a].nTr&&o(t.aoData[a].nTr,w,m)}for(r(t.aoColumns,e,i),r(t.aoPreSearchCols,e,i),a=0,l=t.aoData.length;l>a;a++){var v=t.aoData[a];v.anCells&&r(v.anCells,e,i),"dom"!==v.src&&A.isArray(v._aData)&&r(v._aData,e,i)}for(a=0,l=t.aoHeader.length;l>a;a++)r(t.aoHeader[a],e,i);if(null!==t.aoFooter)for(a=0,l=t.aoFooter.length;l>a;a++)r(t.aoFooter[a],e,i);var E=new A.fn.dataTable.Api(t);for(E.rows().invalidate(),a=0,l=f;l>a;a++)A(t.aoColumns[a].nTh).off("click.DT"),this.oApi._fnSortAttachListener(t,t.aoColumns[a].nTh,a);A(t.oInstance).trigger("column-reorder.dt",[t,{from:e,to:i,mapping:B,drop:s,iFrom:e,iTo:i,aiInvertMapping:B}])}};var a=function(t,e){var i=new A.fn.dataTable.Api(t).settings()[0];if(i._colReorder)return i._colReorder;e===!0&&(e={});var n=A.fn.dataTable.camelToHungarian;return n&&(n(a.defaults,a.defaults,!0),n(a.defaults,e||{})),this.s={dt:null,init:A.extend(!0,{},a.defaults,e),fixed:0,fixedRight:0,reorderCallback:null,mouse:{startX:-1,startY:-1,offsetX:-1,offsetY:-1,target:-1,targetIndex:-1,fromIndex:-1},aoTargets:[]},this.dom={drag:null,pointer:null},this.s.dt=i,this.s.dt._colReorder=this,this._fnConstruct(),this};return A.extend(a.prototype,{fnReset:function(){return this._fnOrderColumns(this.fnOrder()),this},fnGetCurrentOrder:function(){return this.fnOrder()},fnOrder:function(t,e){var r,o,s=[],a=this.s.dt.aoColumns;if(t===i){for(r=0,o=a.length;o>r;r++)s.push(a[r]._ColReorder_iOrigCol);return s}if(e){var l=this.fnOrder();for(r=0,o=t.length;o>r;r++)s.push(A.inArray(t[r],l));t=s}return this._fnOrderColumns(n(t)),this},fnTranspose:function(t,e){e||(e="toCurrent");var i=this.fnOrder(),n=this.s.dt.aoColumns;return"toCurrent"===e?A.isArray(t)?A.map(t,function(t){return A.inArray(t,i)}):A.inArray(t,i):A.isArray(t)?A.map(t,function(A){return n[A]._ColReorder_iOrigCol}):n[t]._ColReorder_iOrigCol},_fnConstruct:function(){var t,e=this,i=this.s.dt.aoColumns.length,r=this.s.dt.nTable;for(this.s.init.iFixedColumns&&(this.s.fixed=this.s.init.iFixedColumns),this.s.init.iFixedColumnsLeft&&(this.s.fixed=this.s.init.iFixedColumnsLeft),this.s.fixedRight=this.s.init.iFixedColumnsRight?this.s.init.iFixedColumnsRight:0,this.s.init.fnReorderCallback&&(this.s.reorderCallback=this.s.init.fnReorderCallback),t=0;i>t;t++)t>this.s.fixed-1&&t<i-this.s.fixedRight&&this._fnMouseListener(t,this.s.dt.aoColumns[t].nTh),this.s.dt.aoColumns[t]._ColReorder_iOrigCol=t;this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(A,t){e._fnStateSave.call(e,t)},"ColReorder_State");var o=null;if(this.s.init.aiOrder&&(o=this.s.init.aiOrder.slice()),this.s.dt.oLoadedState&&"undefined"!=typeof this.s.dt.oLoadedState.ColReorder&&this.s.dt.oLoadedState.ColReorder.length==this.s.dt.aoColumns.length&&(o=this.s.dt.oLoadedState.ColReorder),o)if(e.s.dt._bInitComplete){var s=n(o);e._fnOrderColumns.call(e,s)}else{var a=!1;A(r).on("draw.dt.colReorder",function(){if(!e.s.dt._bInitComplete&&!a){a=!0;var A=n(o);e._fnOrderColumns.call(e,A)}})}else this._fnSetColumnIndexes();A(r).on("destroy.dt.colReorder",function(){A(r).off("destroy.dt.colReorder draw.dt.colReorder"),A(e.s.dt.nTHead).find("*").off(".ColReorder"),A.each(e.s.dt.aoColumns,function(t,e){A(e.nTh).removeAttr("data-column-index")}),e.s.dt._colReorder=null,e.s=null})},_fnOrderColumns:function(t){var e=!1;if(t.length!=this.s.dt.aoColumns.length)return void this.s.dt.oInstance.oApi._fnLog(this.s.dt,1,"ColReorder - array reorder does not match known number of columns. Skipping.");for(var i=0,n=t.length;n>i;i++){var o=A.inArray(i,t);i!=o&&(r(t,o,i),this.s.dt.oInstance.fnColReorder(o,i,!0),e=!0)}this._fnSetColumnIndexes(),e&&(""===this.s.dt.oScroll.sX&&""===this.s.dt.oScroll.sY||this.s.dt.oInstance.fnAdjustColumnSizing(!1),this.s.dt.oInstance.oApi._fnSaveState(this.s.dt),null!==this.s.reorderCallback&&this.s.reorderCallback.call(this))},_fnStateSave:function(t){var e,i,n,r=this.s.dt,o=r.aoColumns;if(t.ColReorder=[],t.aaSorting){for(e=0;e<t.aaSorting.length;e++)t.aaSorting[e][0]=o[t.aaSorting[e][0]]._ColReorder_iOrigCol;var s=A.extend(!0,[],t.aoSearchCols);for(e=0,i=o.length;i>e;e++)n=o[e]._ColReorder_iOrigCol,t.aoSearchCols[n]=s[e],t.abVisCols[n]=o[e].bVisible,t.ColReorder.push(n)}else if(t.order){for(e=0;e<t.order.length;e++)t.order[e][0]=o[t.order[e][0]]._ColReorder_iOrigCol;var a=A.extend(!0,[],t.columns);for(e=0,i=o.length;i>e;e++)n=o[e]._ColReorder_iOrigCol,t.columns[n]=a[e],t.ColReorder.push(n)}},_fnMouseListener:function(t,e){var i=this;A(e).on("mousedown.ColReorder",function(A){A.preventDefault(),i._fnMouseDown.call(i,A,e)})},_fnMouseDown:function(t,n){var r=this,o=A(t.target).closest("th, td"),s=o.offset(),a=parseInt(A(n).attr("data-column-index"),10);a!==i&&(this.s.mouse.startX=t.pageX,this.s.mouse.startY=t.pageY,this.s.mouse.offsetX=t.pageX-s.left,this.s.mouse.offsetY=t.pageY-s.top,this.s.mouse.target=this.s.dt.aoColumns[a].nTh,this.s.mouse.targetIndex=a,this.s.mouse.fromIndex=a,this._fnRegions(),A(e).on("mousemove.ColReorder",function(A){r._fnMouseMove.call(r,A)}).on("mouseup.ColReorder",function(A){r._fnMouseUp.call(r,A)}))},_fnMouseMove:function(A){if(null===this.dom.drag){if(Math.pow(Math.pow(A.pageX-this.s.mouse.startX,2)+Math.pow(A.pageY-this.s.mouse.startY,2),.5)<5)return;this._fnCreateDragNode()}this.dom.drag.css({left:A.pageX-this.s.mouse.offsetX,top:A.pageY-this.s.mouse.offsetY});for(var t=!1,e=this.s.mouse.toIndex,i=1,n=this.s.aoTargets.length;n>i;i++)if(A.pageX<this.s.aoTargets[i-1].x+(this.s.aoTargets[i].x-this.s.aoTargets[i-1].x)/2){this.dom.pointer.css("left",this.s.aoTargets[i-1].x),this.s.mouse.toIndex=this.s.aoTargets[i-1].to,t=!0;break}t||(this.dom.pointer.css("left",this.s.aoTargets[this.s.aoTargets.length-1].x),this.s.mouse.toIndex=this.s.aoTargets[this.s.aoTargets.length-1].to),this.s.init.bRealtime&&e!==this.s.mouse.toIndex&&(this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex,!1),this.s.mouse.fromIndex=this.s.mouse.toIndex,this._fnRegions())},_fnMouseUp:function(){A(e).off("mousemove.ColReorder mouseup.ColReorder"),null!==this.dom.drag&&(this.dom.drag.remove(),this.dom.pointer.remove(),this.dom.drag=null,this.dom.pointer=null,this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex,!0),this._fnSetColumnIndexes(),""===this.s.dt.oScroll.sX&&""===this.s.dt.oScroll.sY||this.s.dt.oInstance.fnAdjustColumnSizing(!1),this.s.dt.oInstance.oApi._fnSaveState(this.s.dt),null!==this.s.reorderCallback&&this.s.reorderCallback.call(this))},_fnRegions:function(){var t=this.s.dt.aoColumns;this.s.aoTargets.splice(0,this.s.aoTargets.length),this.s.aoTargets.push({x:A(this.s.dt.nTable).offset().left,to:0});for(var e=0,i=A(t[0].nTh).offset().left,n=0,r=t.length;r>n;n++)n!=this.s.mouse.fromIndex&&e++,t[n].bVisible&&(i+=A(t[n].nTh).outerWidth(),this.s.aoTargets.push({x:i,to:e}));0!==this.s.fixedRight&&this.s.aoTargets.splice(this.s.aoTargets.length-this.s.fixedRight),0!==this.s.fixed&&this.s.aoTargets.splice(0,this.s.fixed)},_fnCreateDragNode:function(){var t=""!==this.s.dt.oScroll.sX||""!==this.s.dt.oScroll.sY,e=this.s.dt.aoColumns[this.s.mouse.targetIndex].nTh,i=e.parentNode,n=i.parentNode,r=n.parentNode,o=A(e).clone();this.dom.drag=A(r.cloneNode(!1)).addClass("DTCR_clonedTable").append(A(n.cloneNode(!1)).append(A(i.cloneNode(!1)).append(o[0]))).css({position:"absolute",top:0,left:0,width:A(e).outerWidth(),height:A(e).outerHeight()}).appendTo("body"),this.dom.pointer=A("<div></div>").addClass("DTCR_pointer").css({position:"absolute",top:t?A("div.dataTables_scroll",this.s.dt.nTableWrapper).offset().top:A(this.s.dt.nTable).offset().top,height:t?A("div.dataTables_scroll",this.s.dt.nTableWrapper).height():A(this.s.dt.nTable).height()}).appendTo("body")},_fnSetColumnIndexes:function(){A.each(this.s.dt.aoColumns,function(t,e){A(e.nTh).attr("data-column-index",t)})}}),a.defaults={aiOrder:null,bRealtime:!0,iFixedColumnsLeft:0,iFixedColumnsRight:0,fnReorderCallback:null},a.version="1.3.0",A.fn.dataTable.ColReorder=a,A.fn.DataTable.ColReorder=a,"function"==typeof A.fn.dataTable&&"function"==typeof A.fn.dataTableExt.fnVersionCheck&&A.fn.dataTableExt.fnVersionCheck("1.10.8")?A.fn.dataTableExt.aoFeatures.push({fnInit:function(A){var t=A.oInstance;if(A._colReorder)t.oApi._fnLog(A,1,"ColReorder attempted to initialise twice. Ignoring second");else{var e=A.oInit,i=e.colReorder||e.oColReorder||{};new a(A,i)}return null},cFeature:"R",sFeature:"ColReorder"}):alert("Warning: ColReorder requires DataTables 1.10.8 or greater - www.datatables.net/download"),A(e).on("preInit.dt.colReorder",function(t,e){if("dt"===t.namespace){var i=e.oInit.colReorder,n=s.defaults.colReorder;if(i||n){var r=A.extend({},i,n);i!==!1&&new a(e,r)}}}),A.fn.dataTable.Api.register("colReorder.reset()",function(){return this.iterator("table",function(A){A._colReorder.fnReset()})}),A.fn.dataTable.Api.register("colReorder.order()",function(A,t){return A?this.iterator("table",function(e){e._colReorder.fnOrder(A,t)}):this.context.length?this.context[0]._colReorder.fnOrder():null}),A.fn.dataTable.Api.register("colReorder.transpose()",function(A,t){return this.context.length&&this.context[0]._colReorder?this.context[0]._colReorder.fnTranspose(A,t):A}),a});