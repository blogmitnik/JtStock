/*! Select for DataTables 1.1.0
 * 2015 SpryMedia Ltd - datatables.net/license/mit
 */
/**
 * @summary     Select for DataTables
 * @description A collection of API methods, events and buttons for DataTables
 *   that provides selection options of the items in a DataTable
 * @version     1.1.0
 * @file        dataTables.select.js
 * @author      SpryMedia Ltd (www.sprymedia.co.uk)
 * @contact     datatables.net/forums
 * @copyright   Copyright 2015 SpryMedia Ltd.
 *
 * This source file is free software, available under the following license:
 *   MIT license - http://datatables.net/license/mit
 *
 * This source file is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 * or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.
 *
 * For details please refer to: http://www.datatables.net/extensions/select
 */
!function(A){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(t){return A(t,window,document)}):"object"==typeof exports?module.exports=function(t,e){return t||(t=window),e&&e.fn.dataTable||(e=require("datatables.net")(t,e).$),A(e,t,t.document)}:A(jQuery,window,document)}(function(A,t,e,i){"use strict";function n(A,t,e){var i,n,r,s=function(t,e){if(t>e){var i=e;e=t,t=i}var n=!1;return A.columns(":visible").indexes().filter(function(A){return A===t&&(n=!0),A===e?(n=!1,!0):n})},o=function(t,e){var i=A.rows({search:"applied"}).indexes();if(i.indexOf(t)>i.indexOf(e)){var n=e;e=t,t=n}var r=!1;return i.filter(function(A){return A===t&&(r=!0),A===e?(r=!1,!0):r})};A.cells({selected:!0}).any()||e?(n=s(e.column,t.column),r=o(e.row,t.row)):(n=s(0,t.column),r=o(0,t.row)),i=A.cells(r,n).flatten(),A.cells(t,{selected:!0}).any()?A.cells(i).deselect():A.cells(i).select()}function r(t){var e=t.settings()[0],i=e._select.selector;A(t.table().body()).off("mousedown.dtSelect",i).off("mouseup.dtSelect",i).off("click.dtSelect",i),A("body").off("click.dtSelect")}function s(t){var e=A(t.table().body()),i=t.settings()[0],n=i._select.selector;e.on("mousedown.dtSelect",n,function(A){A.shiftKey&&e.css("-moz-user-select","none").one("selectstart.dtSelect",n,function(){return!1})}).on("mouseup.dtSelect",n,function(){e.css("-moz-user-select","")}).on("click.dtSelect",n,function(i){var n,r=t.select.items(),s=t.settings()[0];if(A(i.target).closest("tbody")[0]==e[0]){var o=A(i.target).closest("td, th"),a=t.cell(o).index();t.cell(o).any()&&("row"===r?(n=a.row,u(i,t,s,"row",n)):"column"===r?(n=t.cell(o).index().column,u(i,t,s,"column",n)):"cell"===r&&(n=t.cell(o).index(),u(i,t,s,"cell",n)),s._select_lastCell=a)}}),A("body").on("click.dtSelect",function(e){if(i._select.blurable){if(A(e.target).parents().filter(t.table().container()).length)return;if(A(e.target).parents("div.DTE").length)return;h(i,!0)}})}function o(t,e,i,n){n&&!t.flatten().length||(i.unshift(t),A(t.table().node()).triggerHandler(e+".dt",i))}function a(t){var e=t.settings()[0];if(e._select.info&&e.aanFeatures.i){var i=A('<span class="select-info"/>'),n=function(e,n){i.append(A('<span class="select-item"/>').append(t.i18n("select."+e+"s",{_:"%d "+e+"s selected",0:"",1:"1 "+e+" selected"},n)))};n("row",t.rows({selected:!0}).flatten().length),n("column",t.columns({selected:!0}).flatten().length),n("cell",t.cells({selected:!0}).flatten().length),A.each(e.aanFeatures.i,function(t,e){e=A(e);var n=e.children("span.select-info");n.length&&n.remove(),""!==i.text()&&e.append(i)})}}function l(t){var e=new f.Api(t);t.aoRowCreatedCallback.push({fn:function(e,i,n){var r,s,o=t.aoData[n];for(o._select_selected&&A(e).addClass(t._select.className),r=0,s=t.aoColumns.length;s>r;r++)(t.aoColumns[r]._select_selected||o._selected_cells&&o._selected_cells[r])&&A(o.anCells[r]).addClass(t._select.className)},sName:"select-deferRender"}),e.on("preXhr.dt.dtSelect",function(){var A=e.rows({selected:!0}).ids(!0).filter(function(A){return A!==i}),t=e.cells({selected:!0}).eq(0).map(function(A){var t=e.row(A.row).id(!0);return t?{row:t,column:A.column}:i}).filter(function(A){return A!==i});e.one("draw.dt.dtSelect",function(){e.rows(A).select(),t.any()&&t.each(function(A){e.cells(A.row,A.column).select()})})}),e.on("draw.dtSelect.dt select.dtSelect.dt deselect.dtSelect.dt",function(){a(e)}),e.on("destroy.dtSelect",function(){r(e),e.off(".dtSelect")})}function c(t,e,i,n){var r=t[e+"s"]({search:"applied"}).indexes(),s=A.inArray(n,r),o=A.inArray(i,r);if(t[e+"s"]({selected:!0}).any()||-1!==s){if(s>o){var a=o;o=s,s=a}r.splice(o+1,r.length),r.splice(0,s)}else r.splice(A.inArray(i,r)+1,r.length);t[e](i,{selected:!0}).any()?(r.splice(A.inArray(i,r),1),t[e+"s"](r).deselect()):t[e+"s"](r).select()}function h(A,t){if(t||"single"===A._select.style){var e=new f.Api(A);e.rows({selected:!0}).deselect(),e.columns({selected:!0}).deselect(),e.cells({selected:!0}).deselect()}}function u(A,t,e,i,r){var s=t.select.style(),o=t[i](r,{selected:!0}).any();if("os"===s)if(A.ctrlKey||A.metaKey)t[i](r).select(!o);else if(A.shiftKey)"cell"===i?n(t,r,e._select_lastCell||null):c(t,i,r,e._select_lastCell?e._select_lastCell[i]:null);else{var a=t[i+"s"]({selected:!0});o&&1===a.flatten().length?t[i](r).deselect():(a.deselect(),t[i](r).select())}else t[i](r).select(!o)}function d(A,t){return function(e){return e.i18n("buttons."+A,t)}}var f=A.fn.dataTable;f.select={},f.select.version="1.1.0",A.each([{type:"row",prop:"aoData"},{type:"column",prop:"aoColumns"}],function(A,t){f.ext.selector[t.type].push(function(A,e,n){var r,s=e.selected,o=[];if(s===i)return n;for(var a=0,l=n.length;l>a;a++)r=A[t.prop][n[a]],(s===!0&&r._select_selected===!0||s===!1&&!r._select_selected)&&o.push(n[a]);return o})}),f.ext.selector.cell.push(function(A,t,e){var n,r=t.selected,s=[];if(r===i)return e;for(var o=0,a=e.length;a>o;o++)n=A.aoData[e[o].row],(r===!0&&n._selected_cells&&n._selected_cells[e[o].column]===!0||r===!1&&(!n._selected_cells||!n._selected_cells[e[o].column]))&&s.push(e[o]);return s});var g=f.Api.register,p=f.Api.registerPlural;return g("select()",function(){}),g("select.blurable()",function(A){return A===i?this.context[0]._select.blurable:this.iterator("table",function(t){t._select.blurable=A})}),g("select.info()",function(A){return a===i?this.context[0]._select.info:this.iterator("table",function(t){t._select.info=A})}),g("select.items()",function(A){return A===i?this.context[0]._select.items:this.iterator("table",function(t){t._select.items=A,o(new f.Api(t),"selectItems",[A])})}),g("select.style()",function(A){return A===i?this.context[0]._select.style:this.iterator("table",function(t){t._select.style=A,t._select_init||l(t);var e=new f.Api(t);r(e),"api"!==A&&s(e),o(new f.Api(t),"selectStyle",[A])})}),g("select.selector()",function(A){return A===i?this.context[0]._select.selector:this.iterator("table",function(t){r(new f.Api(t)),t._select.selector=A,"api"!==t._select.style&&s(new f.Api(t))})}),p("rows().select()","row().select()",function(t){var e=this;return t===!1?this.deselect():(this.iterator("row",function(t,e){h(t),t.aoData[e]._select_selected=!0,A(t.aoData[e].nTr).addClass(t._select.className)}),this.iterator("table",function(A,t){o(e,"select",["row",e[t]],!0)}),this)}),p("columns().select()","column().select()",function(t){var e=this;return t===!1?this.deselect():(this.iterator("column",function(t,e){h(t),t.aoColumns[e]._select_selected=!0;var i=new f.Api(t).column(e);A(i.header()).addClass(t._select.className),A(i.footer()).addClass(t._select.className),i.nodes().to$().addClass(t._select.className)}),this.iterator("table",function(A,t){o(e,"select",["column",e[t]],!0)}),this)}),p("cells().select()","cell().select()",function(t){var e=this;return t===!1?this.deselect():(this.iterator("cell",function(t,e,n){h(t);var r=t.aoData[e];r._selected_cells===i&&(r._selected_cells=[]),r._selected_cells[n]=!0,r.anCells&&A(r.anCells[n]).addClass(t._select.className)}),this.iterator("table",function(A,t){o(e,"select",["cell",e[t]],!0)}),this)}),p("rows().deselect()","row().deselect()",function(){var t=this;return this.iterator("row",function(t,e){t.aoData[e]._select_selected=!1,A(t.aoData[e].nTr).removeClass(t._select.className)}),this.iterator("table",function(A,e){o(t,"deselect",["row",t[e]],!0)}),this}),p("columns().deselect()","column().deselect()",function(){var t=this;return this.iterator("column",function(t,e){t.aoColumns[e]._select_selected=!1;var i=new f.Api(t),n=i.column(e);A(n.header()).removeClass(t._select.className),A(n.footer()).removeClass(t._select.className),i.cells(null,e).indexes().each(function(e){var i=t.aoData[e.row],n=i._selected_cells;!i.anCells||n&&n[e.column]||A(i.anCells[e.column]).removeClass(t._select.className)})}),this.iterator("table",function(A,e){o(t,"deselect",["column",t[e]],!0)}),this}),p("cells().deselect()","cell().deselect()",function(){var t=this;return this.iterator("cell",function(t,e,i){var n=t.aoData[e];n._selected_cells[i]=!1,n.anCells&&!t.aoColumns[i]._select_selected&&A(n.anCells[i]).removeClass(t._select.className)}),this.iterator("table",function(A,e){o(t,"deselect",["cell",t[e]],!0)}),this}),A.extend(f.ext.buttons,{selected:{text:d("selected","Selected"),className:"buttons-selected",init:function(A){var t=this;A.on("draw.dt.DT select.dt.DT deselect.dt.DT",function(){var A=t.rows({selected:!0}).any()||t.columns({selected:!0}).any()||t.cells({selected:!0}).any();t.enable(A)}),this.disable()}},selectedSingle:{text:d("selectedSingle","Selected single"),className:"buttons-selected-single",init:function(A){var t=this;A.on("draw.dt.DT select.dt.DT deselect.dt.DT",function(){var e=A.rows({selected:!0}).flatten().length+A.columns({selected:!0}).flatten().length+A.cells({selected:!0}).flatten().length;t.enable(1===e)}),this.disable()}},selectAll:{text:d("selectAll","Select all"),className:"buttons-select-all",action:function(){var A=this.select.items();this[A+"s"]().select()}},selectNone:{text:d("selectNone","Deselect all"),className:"buttons-select-none",action:function(){h(this.settings()[0],!0)}}}),A.each(["Row","Column","Cell"],function(A,t){var e=t.toLowerCase();f.ext.buttons["select"+t+"s"]={text:d("select"+t+"s","Select "+e+"s"),className:"buttons-select-"+e+"s",action:function(){this.select.items(e)},init:function(A){var t=this;A.on("selectItems.dt.DT",function(A,i,n){t.active(n===e)})}}}),A(e).on("preInit.dt.dtSelect",function(t,e){if("dt"===t.namespace){var n=e.oInit.select||f.defaults.select,r=new f.Api(e),s="row",o="api",a=!1,l=!0,c="td, th",h="selected";e._select={},n===!0?o="os":"string"==typeof n?o=n:A.isPlainObject(n)&&(n.blurable!==i&&(a=n.blurable),n.info!==i&&(l=n.info),n.items!==i&&(s=n.items),n.style!==i&&(o=n.style),n.selector!==i&&(c=n.selector),n.className!==i&&(h=n.className)),r.select.selector(c),r.select.items(s),r.select.style(o),r.select.blurable(a),r.select.info(l),e._select.className=h,A(r.table().node()).hasClass("selectable")&&r.select.style("os")}}),f.select});