/*!
 * Responsive Tables v5.0.4 (http://gergeo.se/RWD-Table-Patterns)
 * This is an awesome solution for responsive tables with complex data.
 * Authors: Nadan Gergeo <nadan.gergeo@gmail.com> (www.gergeo.se) & Maggie Wachs (www.filamentgroup.com)
 * Licensed under MIT (https://github.com/nadangergeo/RWD-Table-Patterns/blob/master/LICENSE-MIT)
 */
!function(t){"use strict";function A(){return"undefined"!=typeof window.matchMedia||"undefined"!=typeof window.msMatchMedia||"undefined"!=typeof window.styleMedia}function e(){return"ontouchstart"in window}function i(){return!!(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))}var n=function(A,e){var n=this;if(this.options=e,this.$tableWrapper=null,this.$tableScrollWrapper=t(A),this.$table=t(A).find("table"),1!==this.$table.length)throw new Error("Exactly one table is expected in a .table-responsive div.");this.$tableScrollWrapper.attr("data-pattern",this.options.pattern),this.id=this.$table.prop("id")||this.$tableScrollWrapper.prop("id")||"id"+Math.random().toString(16).slice(2),this.$tableClone=null,this.$stickyTableHeader=null,this.$thead=this.$table.find("thead"),this.$tbody=this.$table.find("tbody"),this.$hdrCells=this.$thead.find("th"),this.$bodyRows=this.$tbody.find("tr"),this.$btnToolbar=null,this.$dropdownGroup=null,this.$dropdownBtn=null,this.$dropdownContainer=null,this.$displayAllBtn=null,this.$focusGroup=null,this.$focusBtn=null,this.displayAllTrigger="display-all-"+this.id+".responsive-table",this.idPrefix=this.id+"-col-",this.iOS=i(),this.wrapTable(),this.createButtonToolbar(),this.setupHdrCells(),this.setupStandardCells(),this.options.stickyTableHeader&&this.createStickyTableHeader(),this.$dropdownContainer.is(":empty")&&this.$dropdownGroup.hide(),t(window).bind("orientationchange resize "+this.displayAllTrigger,function(){n.$dropdownContainer.find("input").trigger("updateCheck"),t.proxy(n.updateSpanningCells(),n)})};n.DEFAULTS={pattern:"priority-columns",stickyTableHeader:!0,fixedNavbar:".navbar-fixed-top",addDisplayAllBtn:!0,addFocusBtn:!0,focusBtnIcon:"glyphicon glyphicon-screenshot"},n.prototype.wrapTable=function(){this.$tableScrollWrapper.wrap('<div class="table-wrapper"/>'),this.$tableWrapper=this.$tableScrollWrapper.parent()},n.prototype.createButtonToolbar=function(){var A=this;this.$btnToolbar=t('<div class="btn-toolbar" />'),this.$dropdownGroup=t('<div class="btn-group dropdown-btn-group pull-right" />'),this.$dropdownBtn=t('<button class="btn btn-default dropdown-toggle" data-toggle="dropdown">Display <span class="caret"></span></button>'),this.$dropdownContainer=t('<ul class="dropdown-menu"/>'),this.options.addFocusBtn&&(this.$focusGroup=t('<div class="btn-group focus-btn-group" />'),this.$focusBtn=t('<button class="btn btn-default">Focus</button>'),this.options.focusBtnIcon&&this.$focusBtn.prepend('<span class="'+this.options.focusBtnIcon+'"></span> '),this.$focusGroup.append(this.$focusBtn),this.$btnToolbar.append(this.$focusGroup),this.$focusBtn.click(function(){t.proxy(A.activateFocus(),A)}),this.$bodyRows.click(function(){t.proxy(A.focusOnRow(t(this)),A)})),this.options.addDisplayAllBtn&&(this.$displayAllBtn=t('<button class="btn btn-default">Display all</button>'),this.$dropdownGroup.append(this.$displayAllBtn),this.$table.hasClass("display-all")&&this.$displayAllBtn.addClass("btn-primary"),this.$displayAllBtn.click(function(){t.proxy(A.displayAll(null,!0),A)})),this.$dropdownGroup.append(this.$dropdownBtn).append(this.$dropdownContainer),this.$btnToolbar.append(this.$dropdownGroup),this.$tableScrollWrapper.before(this.$btnToolbar)},n.prototype.clearAllFocus=function(){this.$bodyRows.removeClass("unfocused"),this.$bodyRows.removeClass("focused")},n.prototype.activateFocus=function(){this.clearAllFocus(),this.$focusBtn&&this.$focusBtn.toggleClass("btn-primary"),this.$table.toggleClass("focus-on")},n.prototype.focusOnRow=function(A){if(this.$table.hasClass("focus-on")){var e=t(A).hasClass("focused");this.clearAllFocus(),e||(this.$bodyRows.addClass("unfocused"),t(A).addClass("focused"))}},n.prototype.displayAll=function(A,e){this.$displayAllBtn&&this.$displayAllBtn.toggleClass("btn-primary",A),this.$table.toggleClass("display-all",A),this.$tableClone&&this.$tableClone.toggleClass("display-all",A),e&&t(window).trigger(this.displayAllTrigger)},n.prototype.preserveDisplayAll=function(){var A="table-cell";t("html").hasClass("lt-ie9")&&(A="inline"),t(this.$table).find("th, td").css("display",A),this.$tableClone&&t(this.$tableClone).find("th, td").css("display",A)},n.prototype.createStickyTableHeader=function(){var A=this;A.$tableClone=A.$table.clone(),A.$tableClone.prop("id",this.id+"-clone"),A.$tableClone.find("[id]").each(function(){t(this).prop("id",t(this).prop("id")+"-clone")}),A.$tableClone.wrap('<div class="sticky-table-header"/>'),A.$stickyTableHeader=A.$tableClone.parent(),A.$stickyTableHeader.css("height",A.$thead.height()+2),t("html").hasClass("lt-ie10")?A.$tableWrapper.prepend(A.$stickyTableHeader):A.$table.before(A.$stickyTableHeader),t(window).bind("scroll resize",function(){t.proxy(A.updateStickyTableHeader(),A)}),t(A.$tableScrollWrapper).bind("scroll",function(){t.proxy(A.updateStickyTableHeader(),A)})},n.prototype.updateStickyTableHeader=function(){var A=this,e=0,i=A.$table.offset().top,n=t(window).scrollTop()-1,r=A.$table.height()-A.$stickyTableHeader.height(),s=n+t(window).height()-t(document).height(),o=!A.iOS,a=0;if(t(A.options.fixedNavbar).length){var l=t(A.options.fixedNavbar).first();a=l.height()+2,n+=a}var h=n>i&&n<i+A.$table.height();if(o){if(A.$stickyTableHeader.scrollLeft(A.$tableScrollWrapper.scrollLeft()),A.$stickyTableHeader.addClass("fixed-solution"),e=a-1,n-i>r?(e-=n-i-r,A.$stickyTableHeader.addClass("border-radius-fix")):A.$stickyTableHeader.removeClass("border-radius-fix"),h)return void A.$stickyTableHeader.css({visibility:"visible",top:e+"px",width:A.$tableScrollWrapper.innerWidth()+"px"});A.$stickyTableHeader.css({visibility:"hidden",width:"auto"})}else{A.$stickyTableHeader.removeClass("fixed-solution");var c=400;e=n-i-1,0>e?e=0:e>r&&(e=r),s>0&&(e-=s),h?(A.$stickyTableHeader.css({visibility:"visible"}),A.$stickyTableHeader.animate({top:e+"px"},c),A.$thead.css({visibility:"hidden"})):A.$stickyTableHeader.animate({top:"0"},c,function(){A.$thead.css({visibility:"visible"}),A.$stickyTableHeader.css({visibility:"hidden"})})}},n.prototype.setupHdrCells=function(){var A=this;A.$hdrCells.each(function(e){var i=t(this),n=i.prop("id"),r=i.text();if(n||(n=A.idPrefix+e,i.prop("id",n)),""===r&&(r=i.attr("data-col-name")),i.is("[data-priority]")){var s=t('<li class="checkbox-row"><input type="checkbox" name="toggle-'+n+'" id="toggle-'+n+'" value="'+n+'" /> <label for="toggle-'+n+'">'+r+"</label></li>"),o=s.find("input");A.$dropdownContainer.append(s),s.click(function(){o.prop("checked",!o.prop("checked")),o.trigger("change")}),t("html").hasClass("lt-ie9")&&o.click(function(){t(this).trigger("change")}),s.find("label").click(function(t){t.stopPropagation()}),s.find("input").click(function(t){t.stopPropagation()}).change(function(){var e=t(this),i=e.val(),n=A.$tableWrapper.find("#"+i+", #"+i+"-clone, [data-columns~="+i+"]");A.$table.hasClass("display-all")&&(t.proxy(A.preserveDisplayAll(),A),A.$table.removeClass("display-all"),A.$tableClone&&A.$tableClone.removeClass("display-all"),A.$displayAllBtn.removeClass("btn-primary")),n.each(function(){var A=t(this);e.is(":checked")?("none"!==A.css("display")&&A.prop("colSpan",parseInt(A.prop("colSpan"))+1),A.show()):parseInt(A.prop("colSpan"))>1?A.prop("colSpan",parseInt(A.prop("colSpan"))-1):A.hide()})}).bind("updateCheck",function(){"none"!==i.css("display")?t(this).prop("checked",!0):t(this).prop("checked",!1)}).trigger("updateCheck")}})},n.prototype.setupStandardCells=function(){var A=this;A.$bodyRows.each(function(){var e=0;t(this).find("th, td").each(function(){for(var i=t(this),n="",r=i.prop("colSpan"),s=0,o=e;e+r>o;o++){n=n+" "+A.idPrefix+o;var a=A.$tableScrollWrapper.find("#"+A.idPrefix+o),l=a.attr("data-priority");l&&i.attr("data-priority",l),"none"===a.css("display")&&s++}r>1&&(i.addClass("spn-cell"),s!==r?i.show():i.hide()),i.prop("colSpan",Math.max(r-s,1)),n=n.substring(1),i.attr("data-columns",n),e+=r})})},n.prototype.updateSpanningCells=function(){var A=this;A.$table.find(".spn-cell").each(function(){for(var A=t(this),e=A.attr("data-columns").split(" "),i=e.length,n=0,r=0;i>r;r++)"none"===t("#"+e[r]).css("display")&&n++;n!==i?A.show():A.hide(),A.prop("colSpan",Math.max(i-n,1))})};var r=t.fn.responsiveTable;t.fn.responsiveTable=function(A){return this.each(function(){var e=t(this),i=e.data("responsiveTable"),r=t.extend({},n.DEFAULTS,e.data(),"object"==typeof A&&A);""!==r.pattern&&(i||e.data("responsiveTable",i=new n(this,r)),"string"==typeof A&&i[A]())})},t.fn.responsiveTable.Constructor=n,t.fn.responsiveTable.noConflict=function(){return t.fn.responsiveTable=r,this},t(document).on("ready.responsive-table.data-api",function(){t("[data-pattern]").each(function(){var A=t(this);A.responsiveTable(A.data())})}),t(document).on("click.dropdown.data-api",".dropdown-menu .checkbox-row",function(t){t.stopPropagation()}),t(document).ready(function(){t("html").removeClass("no-js").addClass("js"),A()?t("html").addClass("mq"):t("html").addClass("no-mq"),e()?t("html").addClass("touch"):t("html").addClass("no-touch")})}(jQuery);