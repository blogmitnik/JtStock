/*!
 * bootstrap-fileinput v4.3.5
 * http://plugins.krajee.com/file-input
 *
 * Author: Kartik Visweswaran
 * Copyright: 2014 - 2016, Kartik Visweswaran, Krajee.com
 *
 * Licensed under the BSD 3-Clause
 * https://github.com/kartik-v/bootstrap-fileinput/blob/master/LICENSE.md
 */
!function(A){"use strict";"function"==typeof define&&define.amd?define(["jquery"],A):"object"==typeof module&&module.exports?module.exports=A(require("jquery")):A(window.jQuery)}(function(A){"use strict";A.fn.fileinputLocales={},A.fn.fileinputThemes={};var t,e,i,n,r,o,s,a,l,c,h,u,d,f,g,p,B,w,m,v,E,b,I,Q,C,D,y,M,F,x,T,P,S,k,Y,U,N,H,R,G,z,j,_,W,L,O,J,V,X,Z,K,q,$,AA,tA,eA,iA,nA,rA,oA,sA,aA,lA,cA,hA,uA,dA,fA;t=".fileinput",e="kvFileinputModal",i='style="width:{width};height:{height};"',n='<param name="controller" value="true" />\n<param name="allowFullScreen" value="true" />\n<param name="allowScriptAccess" value="always" />\n<param name="autoPlay" value="false" />\n<param name="autoStart" value="false" />\n<param name="quality" value="high" />\n',r='<div class="file-preview-other">\n<span class="{previewFileIconClass}">{previewFileIcon}</span>\n</div>',o=window.URL||window.webkitURL,s=function(A,t,e){return void 0!==A&&(e?A===t:A.match(t))},a=function(A){if("Microsoft Internet Explorer"!==navigator.appName)return!1;if(10===A)return new RegExp("msie\\s"+A,"i").test(navigator.userAgent);var t,e=document.createElement("div");return e.innerHTML="<!--[if IE "+A+"]> <i></i> <![endif]-->",t=e.getElementsByTagName("i").length,document.body.appendChild(e),e.parentNode.removeChild(e),t},l=function(A,e,i,n){var r=n?e:e.split(" ").join(t+" ")+t;A.off(r).on(r,i)},c={data:{},init:function(A){var t=A.initialPreview,e=A.id;t.length>0&&!nA(t)&&(t=t.split(A.initialPreviewDelimiter)),c.data[e]={content:t,config:A.initialPreviewConfig,tags:A.initialPreviewThumbTags,delimiter:A.initialPreviewDelimiter,previewFileType:A.initialPreviewFileType,previewAsData:A.initialPreviewAsData,template:A.previewGenericTemplate,showZoom:A.fileActionSettings.showZoom,showDrag:A.fileActionSettings.showDrag,getSize:function(t){return A._getSize(t)},parseTemplate:function(t,e,i,n,r,o,s){var a=" file-preview-initial";return A._generatePreviewTemplate(t,e,i,n,r,!1,null,a,o,s)},msg:function(t){return A._getMsgSelected(t)},initId:A.previewInitId,footer:A._getLayoutTemplate("footer").replace(/\{progress}/g,A._renderThumbProgress()),isDelete:A.initialPreviewShowDelete,caption:A.initialCaption,actions:function(t,e,i,n,r,o,s){return A._renderFileActions(t,e,i,n,r,o,s,!0)}}},fetch:function(A){return c.data[A].content.filter(function(A){return null!==A})},count:function(A,t){return c.data[A]&&c.data[A].content?t?c.data[A].content.length:c.fetch(A).length:0},get:function(t,e,i){var n,r,o,s,a,l,h="init_"+e,u=c.data[t],d=u.config[e],f=u.content[e],g=u.initId+"-"+h,p=" file-preview-initial",B=rA("previewAsData",d,u.previewAsData);return i=void 0===i?!0:i,f?(d&&d.frameClass&&(p+=" "+d.frameClass),B?(o=u.previewAsData?rA("type",d,u.previewFileType||"generic"):"generic",s=rA("caption",d),a=c.footer(t,e,i,d&&d.size||null),l=rA("filetype",d,o),n=u.parseTemplate(o,f,s,l,g,a,h,null)):n=u.template.replace(/\{previewId}/g,g).replace(/\{frameClass}/g,p).replace(/\{fileindex}/g,h).replace(/\{content}/g,u.content[e]).replace(/\{template}/g,rA("type",d,u.previewFileType)).replace(/\{footer}/g,c.footer(t,e,i,d&&d.size||null)),u.tags.length&&u.tags[e]&&(n=aA(n,u.tags[e])),iA(d)||iA(d.frameAttr)||(r=A(document.createElement("div")).html(n),r.find(".file-preview-initial").attr(d.frameAttr),n=r.html(),r.remove()),n):""},add:function(t,e,i,n,r){var o,s=A.extend(!0,{},c.data[t]);return nA(e)||(e=e.split(s.delimiter)),r?(o=s.content.push(e)-1,s.config[o]=i,s.tags[o]=n):(o=e.length-1,s.content=e,s.config=i,s.tags=n),c.data[t]=s,o},set:function(t,e,i,n,r){var o,s,a=A.extend(!0,{},c.data[t]);if(e&&e.length&&(nA(e)||(e=e.split(a.delimiter)),s=e.filter(function(A){return null!==A}),s.length)){if(void 0===a.content&&(a.content=[]),void 0===a.config&&(a.config=[]),void 0===a.tags&&(a.tags=[]),r){for(o=0;o<e.length;o++)e[o]&&a.content.push(e[o]);for(o=0;o<i.length;o++)i[o]&&a.config.push(i[o]);for(o=0;o<n.length;o++)n[o]&&a.tags.push(n[o])}else a.content=e,a.config=i,a.tags=n;c.data[t]=a}},unset:function(A,t){var e=c.count(A);if(e){if(1===e)return c.data[A].content=[],c.data[A].config=[],void(c.data[A].tags=[]);c.data[A].content[t]=null,c.data[A].config[t]=null,c.data[A].tags[t]=null}},out:function(A){var t,e="",i=c.data[A],n=c.count(A,!0);if(0===n)return{content:"",caption:""};for(var r=0;n>r;r++)e+=c.get(A,r);return t=i.msg(c.count(A)),{content:'<div class="file-initial-thumbs">'+e+"</div>",caption:t}},footer:function(A,t,e,i){var n=c.data[A];if(e=void 0===e?!0:e,0===n.config.length||iA(n.config[t]))return"";var r=n.config[t],o=rA("caption",r),s=rA("width",r,"auto"),a=rA("url",r,!1),l=rA("key",r,null),h=rA("showDelete",r,!0),u=rA("showZoom",r,n.showZoom),d=rA("showDrag",r,n.showDrag),f=a===!1&&e,g=n.isDelete?n.actions(!1,h,u,d,f,a,l):"",p=n.footer.replace(/\{actions}/g,g);return p.replace(/\{caption}/g,o).replace(/\{size}/g,n.getSize(i)).replace(/\{width}/g,s).replace(/\{indicator}/g,"").replace(/\{indicatorTitle}/g,"")}},h=function(A,t){return t=t||0,"number"==typeof A?A:("string"==typeof A&&(A=parseFloat(A)),isNaN(A)?t:A)},u=function(){return!(!window.File||!window.FileReader)},d=function(){var A=document.createElement("div");return!a(9)&&(void 0!==A.draggable||void 0!==A.ondragstart&&void 0!==A.ondrop)},f=function(){return u()&&window.FormData},g=function(A,t){A.removeClass(t).addClass(t)},X={showRemove:!0,showUpload:!0,showZoom:!0,showDrag:!0,removeIcon:'<i class="glyphicon glyphicon-trash text-danger"></i>',removeClass:"btn btn-xs btn-default",removeTitle:"Remove file",uploadIcon:'<i class="glyphicon glyphicon-upload text-info"></i>',uploadClass:"btn btn-xs btn-default",uploadTitle:"Upload file",zoomIcon:'<i class="glyphicon glyphicon-zoom-in"></i>',zoomClass:"btn btn-xs btn-default",zoomTitle:"View Details",dragIcon:'<i class="glyphicon glyphicon-menu-hamburger"></i>',dragClass:"text-info",dragTitle:"Move / Rearrange",dragSettings:{},indicatorNew:'<i class="glyphicon glyphicon-hand-down text-warning"></i>',indicatorSuccess:'<i class="glyphicon glyphicon-ok-sign text-success"></i>',indicatorError:'<i class="glyphicon glyphicon-exclamation-sign text-danger"></i>',indicatorLoading:'<i class="glyphicon glyphicon-hand-up text-muted"></i>',indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading ..."},p='{preview}\n<div class="kv-upload-progress hide"></div>\n<div class="input-group {class}">\n   {caption}\n   <div class="input-group-btn">\n       {remove}\n       {cancel}\n       {upload}\n       {browse}\n   </div>\n</div>',B='{preview}\n<div class="kv-upload-progress hide"></div>\n{remove}\n{cancel}\n{upload}\n{browse}\n',w='<div class="file-preview {class}">\n    {close}    <div class="{dropClass}">\n    <div class="file-preview-thumbnails">\n    </div>\n    <div class="clearfix"></div>    <div class="file-preview-status text-center text-success"></div>\n    <div class="kv-fileinput-error"></div>\n    </div>\n</div>',v='<div class="close fileinput-remove">&times;</div>\n',m='<i class="glyphicon glyphicon-file kv-caption-icon"></i>',E='<div tabindex="500" class="form-control file-caption {class}">\n   <div class="file-caption-name"></div>\n</div>\n',b='<button type="{type}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</button>',I='<a href="{href}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</a>',Q='<div tabindex="500" class="{css}" {status}>{icon} {label}</div>',C='<div id="'+e+'" class="file-zoom-dialog modal fade" tabindex="-1" aria-labelledby="'+e+'Label"></div>',D='<div class="modal-dialog modal-lg" role="document">\n  <div class="modal-content">\n    <div class="modal-header">\n      <div class="kv-zoom-actions pull-right">{toggleheader}{fullscreen}{borderless}{close}</div>\n      <h3 class="modal-title">{heading} <small><span class="kv-zoom-title"></span></small></h3>\n    </div>\n    <div class="modal-body">\n      <div class="floating-buttons"></div>\n      <div class="kv-zoom-body file-zoom-content"></div>\n{prev} {next}\n    </div>\n  </div>\n</div>\n',y='<div class="progress">\n    <div class="{class}" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">\n        {percent}%\n     </div>\n</div>',M=" <br><samp>({sizeText})</samp>",F='<div class="file-thumbnail-footer">\n    <div class="file-footer-caption" title="{caption}">{caption}{size}</div>\n    {progress} {actions}\n</div>',x='<div class="file-actions">\n    <div class="file-footer-buttons">\n        {upload} {delete} {zoom} {other}    </div>\n    {drag}\n    <div class="file-upload-indicator" title="{indicatorTitle}">{indicator}</div>\n    <div class="clearfix"></div>\n</div>',T='<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}" {dataUrl}{dataKey}>{removeIcon}</button>\n',P='<button type="button" class="kv-file-upload {uploadClass}" title="{uploadTitle}">{uploadIcon}</button>',S='<button type="button" class="kv-file-zoom {zoomClass}" title="{zoomTitle}">{zoomIcon}</button>',k='<span class="file-drag-handle {dragClass}" title="{dragTitle}">{dragIcon}</span>',Y='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}"',U=Y+'><div class="kv-file-content">\n',N=Y+' title="{caption}" '+i+'><div class="kv-file-content">\n',H="</div>{footer}\n</div>\n",R="{content}\n",G='<div class="kv-preview-data file-preview-html" title="{caption}" '+i+">{data}</div>\n",z='<img src="{data}" class="kv-preview-data file-preview-image" title="{caption}" alt="{caption}" '+i+">\n",j='<textarea class="kv-preview-data file-preview-text" title="{caption}" readonly '+i+">{data}</textarea>\n",_='<video class="kv-preview-data" width="{width}" height="{height}" controls>\n<source src="{data}" type="{type}">\n'+r+"\n</video>\n",W='<audio class="kv-preview-data" controls>\n<source src="{data}" type="{type}">\n'+r+"\n</audio>\n",L='<object class="kv-preview-data file-object" type="application/x-shockwave-flash" width="{width}" height="{height}" data="{data}">\n'+n+" "+r+"\n</object>\n",O='<object class="kv-preview-data file-object" data="{data}" type="{type}" width="{width}" height="{height}">\n<param name="movie" value="{caption}" />\n'+n+" "+r+"\n</object>\n",J='<embed class="kv-preview-data" src="{data}" width="{width}" height="{height}" type="application/pdf">\n',V='<div class="kv-preview-data file-preview-other-frame">\n'+r+"\n</div>\n",Z={main1:p,main2:B,preview:w,close:v,fileIcon:m,caption:E,modalMain:C,modal:D,progress:y,size:M,footer:F,actions:x,actionDelete:T,actionUpload:P,actionZoom:S,actionDrag:k,btnDefault:b,btnLink:I,btnBrowse:Q},K={generic:U+R+H,html:U+G+H,image:U+z+H,text:U+j+H,video:N+_+H,audio:N+W+H,flash:N+L+H,object:N+O+H,pdf:N+J+H,other:N+V+H},$=["image","html","text","video","audio","flash","pdf","object"],tA={image:{width:"auto",height:"160px"},html:{width:"213px",height:"160px"},text:{width:"213px",height:"160px"},video:{width:"213px",height:"160px"},audio:{width:"213px",height:"80px"},flash:{width:"213px",height:"160px"},object:{width:"160px",height:"160px"},pdf:{width:"160px",height:"160px"},other:{width:"160px",height:"160px"}},q={image:{width:"100%",height:"100%"},html:{width:"100%",height:"100%","min-height":"480px"},text:{width:"100%",height:"100%","min-height":"480px"},video:{width:"auto",height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"480px"},object:{width:"auto",height:"100%","min-height":"480px"},pdf:{width:"100%",height:"100%","min-height":"480px"},other:{width:"auto",height:"100%","min-height":"480px"}},eA={image:function(A,t){return s(A,"image.*")||s(t,/\.(gif|png|jpe?g)$/i)},html:function(A,t){return s(A,"text/html")||s(t,/\.(htm|html)$/i)},text:function(A,t){return s(A,"text.*")||s(t,/\.(xml|javascript)$/i)||s(t,/\.(txt|md|csv|nfo|ini|json|php|js|css)$/i)},video:function(A,t){return s(A,"video.*")&&(s(A,/(ogg|mp4|mp?g|webm|3gp)$/i)||s(t,/\.(og?|mp4|webm|mp?g|3gp)$/i))},audio:function(A,t){return s(A,"audio.*")&&(s(t,/(ogg|mp3|mp?g|wav)$/i)||s(t,/\.(og?|mp3|mp?g|wav)$/i))},flash:function(A,t){return s(A,"application/x-shockwave-flash",!0)||s(t,/\.(swf)$/i)},pdf:function(A,t){return s(A,"application/pdf",!0)||s(t,/\.(pdf)$/i)},object:function(){return!0},other:function(){return!0}},iA=function(t,e){return void 0===t||null===t||0===t.length||e&&""===A.trim(t)},nA=function(A){return Array.isArray(A)||"[object Array]"===Object.prototype.toString.call(A)},rA=function(A,t,e){return e=e||"",t&&"object"==typeof t&&A in t?t[A]:e},AA=function(t,e,i){return iA(t)||iA(t[e])?i:A(t[e])},oA=function(){return Math.round((new Date).getTime()+100*Math.random())},sA=function(A){return A.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},aA=function(t,e){var i=t;return e?(A.each(e,function(A,t){"function"==typeof t&&(t=t()),i=i.split(A).join(t)}),i):i},lA=function(A){var t=A.is("img")?A.attr("src"):A.find("source").attr("src");o.revokeObjectURL(t)},cA=function(A){var t=A.lastIndexOf("/");return-1===t&&(t=A.lastIndexOf("\\")),A.split(A.substring(t,t+1)).pop()},hA=function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},uA=function(A){A&&!hA()?document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},dA=function(A,t,e){if(e>=A.length)for(var i=e-A.length;i--+1;)A.push(void 0);return A.splice(e,0,A.splice(t,1)[0]),A},fA=function(t,e){var i=this;i.$element=A(t),i._validate()&&(i.isPreviewable=u(),i.isIE9=a(9),i.isIE10=a(10),i.isPreviewable||i.isIE9?(i._init(e),i._listen()):i.$element.removeClass("file-loading"))},fA.prototype={constructor:fA,_init:function(t){var e,i=this,n=i.$element;A.each(t,function(A,t){switch(A){case"minFileCount":case"maxFileCount":case"maxFileSize":i[A]=h(t);break;default:i[A]=t}}),i.fileInputCleared=!1,i.fileBatchCompleted=!0,i.isPreviewable||(i.showPreview=!1),i.uploadFileAttr=iA(n.attr("name"))?"file_data":n.attr("name"),i.reader=null,i.formdata={},i.clearStack(),i.uploadCount=0,i.uploadStatus={},i.uploadLog=[],i.uploadAsyncCount=0,i.loadedImages=[],i.totalImagesCount=0,i.ajaxRequests=[],i.isError=!1,i.ajaxAborted=!1,i.cancelling=!1,e=i._getLayoutTemplate("progress"),i.progressTemplate=e.replace("{class}",i.progressClass),i.progressCompleteTemplate=e.replace("{class}",i.progressCompleteClass),i.progressErrorTemplate=e.replace("{class}",i.progressErrorClass),i.dropZoneEnabled=d()&&i.dropZoneEnabled,i.isDisabled=i.$element.attr("disabled")||i.$element.attr("readonly"),i.isUploadable=f()&&!iA(i.uploadUrl),i.isClickable=i.browseOnZoneClick&&i.showPreview&&(i.isUploadable&&i.dropZoneEnabled||!iA(i.defaultPreviewContent)),i.slug="function"==typeof t.slugCallback?t.slugCallback:i._slugDefault,i.mainTemplate=i.showCaption?i._getLayoutTemplate("main1"):i._getLayoutTemplate("main2"),i.captionTemplate=i._getLayoutTemplate("caption"),i.previewGenericTemplate=i._getPreviewTemplate("generic"),i.resizeImage&&(i.maxImageWidth||i.maxImageHeight)&&(i.imageCanvas=document.createElement("canvas"),i.imageCanvasContext=i.imageCanvas.getContext("2d")),iA(i.$element.attr("id"))&&i.$element.attr("id",oA()),void 0===i.$container?i.$container=i._createContainer():i._refreshContainer(),i.$dropZone=i.$container.find(".file-drop-zone"),i.$progress=i.$container.find(".kv-upload-progress"),i.$btnUpload=i.$container.find(".fileinput-upload"),i.$captionContainer=AA(t,"elCaptionContainer",i.$container.find(".file-caption")),i.$caption=AA(t,"elCaptionText",i.$container.find(".file-caption-name")),i.$previewContainer=AA(t,"elPreviewContainer",i.$container.find(".file-preview")),i.$preview=AA(t,"elPreviewImage",i.$container.find(".file-preview-thumbnails")),i.$previewStatus=AA(t,"elPreviewStatus",i.$container.find(".file-preview-status")),i.$errorContainer=AA(t,"elErrorContainer",i.$previewContainer.find(".kv-fileinput-error")),iA(i.msgErrorClass)||g(i.$errorContainer,i.msgErrorClass),i.$errorContainer.hide(),i.fileActionSettings=A.extend(!0,X,t.fileActionSettings),i.previewInitId="preview-"+oA(),i.id=i.$element.attr("id"),c.init(i),i._initPreview(!0),i._initPreviewActions(),i.options=t,i._setFileDropZoneTitle(),i.$element.removeClass("file-loading"),i.$element.attr("disabled")&&i.disable(),i._initZoom()},_validate:function(){var A,t=this;return"file"===t.$element.attr("type")?!0:(A='<div class="help-block alert alert-warning"><h4>Invalid Input Type</h4>You must set an input <code>type = file</code> for <b>bootstrap-fileinput</b> plugin to initialize.</div>',t.$element.after(A),!1)},_errorsExist:function(){var t,e=this;return e.$errorContainer.find("li").length?!0:(t=A(document.createElement("div")).html(e.$errorContainer.html()),t.find("span.kv-error-close").remove(),t.find("ul").remove(),!!A.trim(t.text()).length)},_errorHandler:function(A,t){var e=this,i=A.target.error;i.code===i.NOT_FOUND_ERR?e._showError(e.msgFileNotFound.replace("{name}",t)):i.code===i.SECURITY_ERR?e._showError(e.msgFileSecured.replace("{name}",t)):i.code===i.NOT_READABLE_ERR?e._showError(e.msgFileNotReadable.replace("{name}",t)):i.code===i.ABORT_ERR?e._showError(e.msgFilePreviewAborted.replace("{name}",t)):e._showError(e.msgFilePreviewError.replace("{name}",t))},_addError:function(A){var t=this,e=t.$errorContainer;A&&e.length&&(e.html(t.errorCloseButton+A),l(e.find(".kv-error-close"),"click",function(){e.fadeOut("slow")}))},_resetErrors:function(A){var t=this,e=t.$errorContainer;t.isError=!1,t.$container.removeClass("has-error"),e.html(""),A?e.fadeOut("slow"):e.hide()},_showFolderError:function(A){var t,e=this,i=e.$errorContainer;A&&(t=e.msgFoldersNotAllowed.replace(/\{n}/g,A),e._addError(t),g(e.$container,"has-error"),i.fadeIn(800),e._raise("filefoldererror",[A,t]))},_showUploadError:function(A,t,e){var i=this,n=i.$errorContainer,r=e||"fileuploaderror",o=t&&t.id?'<li data-file-id="'+t.id+'">'+A+"</li>":"<li>"+A+"</li>";return 0===n.find("ul").length?i._addError("<ul>"+o+"</ul>"):n.find("ul").append(o),n.fadeIn(800),i._raise(r,[t,A]),i.$container.removeClass("file-input-new"),g(i.$container,"has-error"),!0},_showError:function(A,t,e){var i=this,n=i.$errorContainer,r=e||"fileerror";return t=t||{},t.reader=i.reader,i._addError(A),n.fadeIn(800),i._raise(r,[t,A]),i.isUploadable||i._clearFileInput(),i.$container.removeClass("file-input-new"),g(i.$container,"has-error"),i.$btnUpload.attr("disabled",!0),!0},_noFilesError:function(A){var t=this,e=t.minFileCount>1?t.filePlural:t.fileSingle,i=t.msgFilesTooLess.replace("{n}",t.minFileCount).replace("{files}",e),n=t.$errorContainer;t._addError(i),t.isError=!0,t._updateFileDetails(0),n.fadeIn(800),t._raise("fileerror",[A,i]),t._clearFileInput(),g(t.$container,"has-error")},_parseError:function(t,e,i){var n=this,r=A.trim(e+""),o="."===r.slice(-1)?"":".",s=void 0!==t.responseJSON&&void 0!==t.responseJSON.error?t.responseJSON.error:t.responseText;return n.cancelling&&n.msgUploadAborted&&(r=n.msgUploadAborted),n.showAjaxErrorDetails&&s?(s=A.trim(s.replace(/\n\s*\n/g,"\n")),s=s.length>0?"<pre>"+s+"</pre>":"",r+=o+s):r+=o,n.cancelling=!1,i?"<b>"+i+": </b>"+r:r},_parseFileType:function(A){var t,e,i,n,r=this;for(n=0;n<$.length;n+=1)if(i=$[n],t=rA(i,r.fileTypeSettings,eA[i]),e=t(A.type,A.name)?i:"",!iA(e))return e;return"other"},_parseFilePreviewIcon:function(t,e){var i,n,r=this,o=r.previewFileIcon;return e&&e.indexOf(".")>-1&&(n=e.split(".").pop(),r.previewFileIconSettings&&r.previewFileIconSettings[n]&&(o=r.previewFileIconSettings[n]),r.previewFileExtSettings&&A.each(r.previewFileExtSettings,function(A,t){return r.previewFileIconSettings[A]&&t(n)?void(o=r.previewFileIconSettings[A]):void(i=!0)})),t.indexOf("{previewFileIcon}")>-1?t.replace(/\{previewFileIconClass}/g,r.previewFileIconClass).replace(/\{previewFileIcon}/g,o):t},_raise:function(t,e){var i=this,n=A.Event(t);if(void 0!==e?i.$element.trigger(n,e):i.$element.trigger(n),n.isDefaultPrevented())return!1;if(!n.result)return n.result;switch(t){case"filebatchuploadcomplete":case"filebatchuploadsuccess":case"fileuploaded":case"fileclear":case"filecleared":case"filereset":case"fileerror":case"filefoldererror":case"fileuploaderror":case"filebatchuploaderror":case"filedeleteerror":case"filecustomerror":case"filesuccessremove":break;default:i.ajaxAborted=n.result}return!0},_listenFullScreen:function(A){var t,e,i=this,n=i.$modal;n&&n.length&&(t=n&&n.find(".btn-fullscreen"),e=n&&n.find(".btn-borderless"),t.length&&e.length&&(t.removeClass("active").attr("aria-pressed","false"),e.removeClass("active").attr("aria-pressed","false"),A?t.addClass("active").attr("aria-pressed","true"):e.addClass("active").attr("aria-pressed","true"),n.hasClass("file-zoom-fullscreen")?i._maximizeZoomDialog():A?i._maximizeZoomDialog():e.removeClass("active").attr("aria-pressed","false")))},_listen:function(){var t=this,e=t.$element,i=e.closest("form"),n=t.$container;l(e,"change",A.proxy(t._change,t)),t.showBrowse&&l(t.$btnFile,"click",A.proxy(t._browse,t)),l(i,"reset",A.proxy(t.reset,t)),l(n.find(".fileinput-remove:not([disabled])"),"click",A.proxy(t.clear,t)),l(n.find(".fileinput-cancel"),"click",A.proxy(t.cancel,t)),t._initDragDrop(),t.isUploadable||l(i,"submit",A.proxy(t._submitForm,t)),l(t.$container.find(".fileinput-upload"),"click",A.proxy(t._uploadClick,t)),l(A(window),"resize",function(){t._listenFullScreen(screen.width===window.innerWidth&&screen.height===window.innerHeight)}),l(A(document),"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){t._listenFullScreen(hA())}),t._initClickable()},_initClickable:function(){var t,e=this;e.isClickable&&(t=e.isUploadable?e.$dropZone:e.$preview.find(".file-default-preview"),g(t,"clickable"),t.attr("tabindex",-1),l(t,"click",function(i){var n=A(i.target);n.parents(".file-preview-thumbnails").length&&!n.parents(".file-default-preview").length||(e.$element.trigger("click"),t.blur())}))},_initDragDrop:function(){var t=this,e=t.$dropZone;t.isUploadable&&t.dropZoneEnabled&&t.showPreview&&(l(e,"dragenter dragover",A.proxy(t._zoneDragEnter,t)),l(e,"dragleave",A.proxy(t._zoneDragLeave,t)),l(e,"drop",A.proxy(t._zoneDrop,t)),l(A(document),"dragenter dragover drop",t._zoneDragDropInit))},_zoneDragDropInit:function(A){A.stopPropagation(),A.preventDefault()},_zoneDragEnter:function(t){var e=this,i=A.inArray("Files",t.originalEvent.dataTransfer.types)>-1;return e._zoneDragDropInit(t),e.isDisabled||!i?(t.originalEvent.dataTransfer.effectAllowed="none",void(t.originalEvent.dataTransfer.dropEffect="none")):void g(e.$dropZone,"file-highlighted")},_zoneDragLeave:function(A){var t=this;t._zoneDragDropInit(A),t.isDisabled||t.$dropZone.removeClass("file-highlighted")},_zoneDrop:function(A){var t=this;A.preventDefault(),t.isDisabled||iA(A.originalEvent.dataTransfer.files)||(t._change(A,"dragdrop"),t.$dropZone.removeClass("file-highlighted"))},_uploadClick:function(A){var t,e=this,i=e.$container.find(".fileinput-upload"),n=!i.hasClass("disabled")&&iA(i.attr("disabled"));if(!A||!A.isDefaultPrevented()){if(!e.isUploadable)return void(n&&"submit"!==i.attr("type")&&(t=i.closest("form"),t.length&&t.trigger("submit"),A.preventDefault()));A.preventDefault(),n&&e.upload()}},_submitForm:function(){var A=this,t=A.$element,e=t.get(0).files;return e&&A.minFileCount>0&&A._getFileCount(e.length)<A.minFileCount?(A._noFilesError({}),!1):!A._abort({})},_clearPreview:function(){var A=this,t=A.showUploadedThumbs?A.$preview.find(".file-preview-frame:not(.file-preview-success)"):A.$preview.find(".file-preview-frame");t.remove(),A.$preview.find(".file-preview-frame").length&&A.showPreview||A._resetUpload(),A._validateDefaultPreview()},_initSortable:function(){var t,e,i=this,n=i.$preview;window.KvSortable&&(t=n.find(".file-initial-thumbs"),e={handle:".drag-handle-init",dataIdAttr:"data-preview-id",draggable:".file-preview-initial",onSort:function(t){var e=t.oldIndex,n=t.newIndex;i.initialPreview=dA(i.initialPreview,e,n),i.initialPreviewConfig=dA(i.initialPreviewConfig,e,n),c.init(i),i._raise("filesorted",{previewId:A(t.item).attr("id"),oldIndex:e,newIndex:n,stack:i.initialPreviewConfig})}},t.data("kvsortable")&&t.kvsortable("destroy"),A.extend(!0,e,i.fileActionSettings.dragSettings),t.kvsortable(e))},_initPreview:function(A){var t,e=this,i=e.initialCaption||"";return c.count(e.id)?(t=c.out(e.id),i=A&&e.initialCaption?e.initialCaption:t.caption,e.$preview.html(t.content),e._setCaption(i),e._initSortable(),void(iA(t.content)||e.$container.removeClass("file-input-new"))):(e._clearPreview(),void(A?e._setCaption(i):e._initCaption()))},_getZoomButton:function(A){var t=this,e=t.previewZoomButtonIcons[A],i=t.previewZoomButtonClasses[A],n=' title="'+(t.previewZoomButtonTitles[A]||"")+'" ',r=n+("close"===A?' data-dismiss="modal" aria-hidden="true"':"");return"fullscreen"!==A&&"borderless"!==A&&"toggleheader"!==A||(r+=' data-toggle="button" aria-pressed="false" autocomplete="off"'),'<button type="button" class="'+i+" btn-"+A+'"'+r+">"+e+"</button>"},_getModalContent:function(){var A=this;return A._getLayoutTemplate("modal").replace(/\{heading}/g,A.msgZoomModalHeading).replace(/\{prev}/g,A._getZoomButton("prev")).replace(/\{next}/g,A._getZoomButton("next")).replace(/\{toggleheader}/g,A._getZoomButton("toggleheader")).replace(/\{fullscreen}/g,A._getZoomButton("fullscreen")).replace(/\{borderless}/g,A._getZoomButton("borderless")).replace(/\{close}/g,A._getZoomButton("close"))},_listenModalEvent:function(A){var t=this,e=t.$modal,i=function(A){return{sourceEvent:A,previewId:e.data("previewId"),modal:e}};e.on(A+".bs.modal",function(n){var r=e.find(".btn-fullscreen"),o=e.find(".btn-borderless");t._raise("filezoom"+A,i(n)),"shown"===A&&(o.removeClass("active").attr("aria-pressed","false"),r.removeClass("active").attr("aria-pressed","false"),e.hasClass("file-zoom-fullscreen")&&(t._maximizeZoomDialog(),hA()?r.addClass("active").attr("aria-pressed","true"):o.addClass("active").attr("aria-pressed","true")))})},_initZoom:function(){var t,i=this,n=i._getLayoutTemplate("modalMain"),r="#"+e;i.$modal=A(r),i.$modal&&i.$modal.length||(t=A(document.createElement("div")).html(n).insertAfter(i.$container),i.$modal=A("#"+e).insertBefore(t),t.remove()),i.$modal.html(i._getModalContent()),i._listenModalEvent("show"),i._listenModalEvent("shown"),i._listenModalEvent("hide"),i._listenModalEvent("hidden"),i._listenModalEvent("loaded")},_initZoomButtons:function(){var t,e,i=this,n=i.$modal.data("previewId")||"",r=i.$preview.find(".file-preview-frame").toArray(),o=r.length,s=i.$modal.find(".btn-prev"),a=i.$modal.find(".btn-next");o&&(t=A(r[0]),e=A(r[o-1]),s.removeAttr("disabled"),a.removeAttr("disabled"),t.length&&t.attr("id")===n&&s.attr("disabled",!0),e.length&&e.attr("id")===n&&a.attr("disabled",!0))},_maximizeZoomDialog:function(){var t=this,e=t.$modal,i=e.find(".modal-header:visible"),n=e.find(".modal-footer:visible"),r=e.find(".modal-body"),o=A(window).height(),s=0;e.addClass("file-zoom-fullscreen"),i&&i.length&&(o-=i.outerHeight(!0)),n&&n.length&&(o-=n.outerHeight(!0)),r&&r.length&&(s=r.outerHeight(!0)-r.height(),o-=s),e.find(".kv-zoom-body").height(o)},_resizeZoomDialog:function(A){var t=this,e=t.$modal,i=e.find(".btn-fullscreen"),n=e.find(".btn-borderless");if(e.hasClass("file-zoom-fullscreen"))uA(!1),A?i.hasClass("active")||(e.removeClass("file-zoom-fullscreen"),t._resizeZoomDialog(!0),n.hasClass("active")&&n.removeClass("active").attr("aria-pressed","false")):i.hasClass("active")?i.removeClass("active").attr("aria-pressed","false"):(e.removeClass("file-zoom-fullscreen"),t.$modal.find(".kv-zoom-body").css("height",t.zoomModalHeight));else{if(!A)return void t._maximizeZoomDialog();uA(!0)}e.focus()},_setZoomContent:function(t,e){var i,n,r,o,s,a,c,h,u=this,d=t.attr("id"),f=u.$modal,p=f.find(".btn-prev"),B=f.find(".btn-next"),w=f.find(".btn-fullscreen"),m=f.find(".btn-borderless"),v=f.find(".btn-toggleheader");n=t.data("template")||"generic",i=t.find(".kv-file-content"),r=i.length?i.html():"",o=t.find(".file-footer-caption").text()||"",f.find(".kv-zoom-title").html(o),s=f.find(".kv-zoom-body"),e?(h=s.clone().insertAfter(s),s.html(r).hide(),h.fadeOut("fast",function(){s.fadeIn("fast"),h.remove()})):s.html(r),c=u.previewZoomSettings[n],c&&(a=s.find(".kv-preview-data"),g(a,"file-zoom-detail"),A.each(c,function(A,t){a.css(A,t),(a.attr("width")&&"width"===A||a.attr("height")&&"height"===A)&&a.removeAttr(A)})),f.data("previewId",d),l(p,"click",function(){u._zoomSlideShow("prev",d)}),l(B,"click",function(){u._zoomSlideShow("next",d)}),l(w,"click",function(){u._resizeZoomDialog(!0)}),l(m,"click",function(){u._resizeZoomDialog(!1)}),l(v,"click",function(){var A,t=f.find(".modal-header"),e=f.find(".modal-body .floating-buttons"),i=t.find(".kv-zoom-actions"),n=function(A){var e=u.$modal.find(".kv-zoom-body"),i=u.zoomModalHeight;f.hasClass("file-zoom-fullscreen")&&(i=e.outerHeight(!0),A||(i-=t.outerHeight(!0))),e.css("height",A?i+A:i)};t.is(":visible")?(A=t.outerHeight(!0),t.slideUp("slow",function(){i.find(".btn").appendTo(e),n(A)})):(e.find(".btn").appendTo(i),t.slideDown("slow",function(){n()})),f.focus()}),l(f,"keydown",function(A){var t=A.which||A.keyCode;37!==t||p.attr("disabled")||u._zoomSlideShow("prev",d),39!==t||B.attr("disabled")||u._zoomSlideShow("next",d)})},_zoomPreview:function(A){var t,e=this;if(!A.length)throw"Cannot zoom to detailed preview!";e.$modal.html(e._getModalContent()),t=A.closest(".file-preview-frame"),e._setZoomContent(t),e.$modal.modal("show"),e._initZoomButtons()},_zoomSlideShow:function(t,e){var i,n,r,o=this,s=o.$modal.find(".kv-zoom-actions .btn-"+t),a=o.$preview.find(".file-preview-frame").toArray(),l=a.length;if(!s.attr("disabled")){for(n=0;l>n;n++)if(A(a[n]).attr("id")===e){r="prev"===t?n-1:n+1;break}0>r||r>=l||!a[r]||(i=A(a[r]),i.length&&o._setZoomContent(i,!0),o._initZoomButtons(),o._raise("filezoom"+t,{previewId:e,modal:o.$modal}))}},_initZoomButton:function(){var t=this;t.$preview.find(".kv-file-zoom").each(function(){var e=A(this);l(e,"click",function(){t._zoomPreview(e)})})},_initPreviewActions:function(){var t=this,e=t.deleteExtraData||{},i=function(){var A=t.isUploadable?c.count(t.id):t.$element.get(0).files.length;0!==t.$preview.find(".kv-file-remove").length||A||(t.reset(),t.initialCaption="")};t._initZoomButton(),t.$preview.find(".kv-file-remove").each(function(){var n=A(this),r=n.data("url")||t.deleteUrl,o=n.data("key");if(!iA(r)&&void 0!==o){var s,a,h,u,d=n.closest(".file-preview-frame"),f=c.data[t.id],p=d.data("fileindex");p=parseInt(p.replace("init_","")),h=iA(f.config)&&iA(f.config[p])?null:f.config[p],u=iA(h)||iA(h.extra)?e:h.extra,"function"==typeof u&&(u=u()),a={id:n.attr("id"),key:o,extra:u},s=A.extend(!0,{},{url:r,type:"POST",dataType:"json",data:A.extend(!0,{},{key:o},u),beforeSend:function(A){t.ajaxAborted=!1,t._raise("filepredelete",[o,A,u]),t.ajaxAborted?A.abort():(g(d,"file-uploading"),g(n,"disabled"))},success:function(A,e,r){var s,l;return iA(A)||iA(A.error)?(c.unset(t.id,p),s=c.count(t.id),l=s>0?t._getMsgSelected(s):"",t._raise("filedeleted",[o,r,u]),t._setCaption(l),d.removeClass("file-uploading").addClass("file-deleted"),void d.fadeOut("slow",function(){t._clearObjects(d),d.remove(),i(),s||0!==t.getFileStack().length||(t._setCaption(""),t.reset())})):(a.jqXHR=r,a.response=A,t._showError(A.error,a,"filedeleteerror"),d.removeClass("file-uploading"),n.removeClass("disabled"),void i())},error:function(A,e,n){var r=t._parseError(A,n);a.jqXHR=A,a.response={},t._showError(r,a,"filedeleteerror"),d.removeClass("file-uploading"),i()}},t.ajaxDeleteSettings),l(n,"click",function(){return t._validateMinCount()?void A.ajax(s):!1})}})},_clearObjects:function(t){t.find("video audio").each(function(){this.pause(),A(this).remove()}),t.find("img object div").each(function(){A(this).remove()})},_clearFileInput:function(){var t,e,i,n=this,r=n.$element;iA(r.val())||(n.isIE9||n.isIE10?(t=r.closest("form"),e=A(document.createElement("form")),i=A(document.createElement("div")),r.before(i),t.length?t.after(e):i.after(e),e.append(r).trigger("reset"),i.before(r).remove(),e.remove()):r.val(""),n.fileInputCleared=!0)},_resetUpload:function(){var A=this;A.uploadCache={content:[],config:[],tags:[],append:!0
},A.uploadCount=0,A.uploadStatus={},A.uploadLog=[],A.uploadAsyncCount=0,A.loadedImages=[],A.totalImagesCount=0,A.$btnUpload.removeAttr("disabled"),A._setProgress(0),g(A.$progress,"hide"),A._resetErrors(!1),A.ajaxAborted=!1,A.ajaxRequests=[],A._resetCanvas()},_resetCanvas:function(){var A=this;A.canvas&&A.imageCanvasContext&&A.imageCanvasContext.clearRect(0,0,A.canvas.width,A.canvas.height)},_hasInitialPreview:function(){var A=this;return!A.overwriteInitial&&c.count(A.id)},_resetPreview:function(){var A,t,e=this;c.count(e.id)?(A=c.out(e.id),e.$preview.html(A.content),t=e.initialCaption?e.initialCaption:A.caption,e._setCaption(t)):(e._clearPreview(),e._initCaption()),e.showPreview&&(e._initZoom(),e._initSortable())},_clearDefaultPreview:function(){var A=this;A.$preview.find(".file-default-preview").remove()},_validateDefaultPreview:function(){var A=this;A.showPreview&&!iA(A.defaultPreviewContent)&&(A.$preview.html('<div class="file-default-preview">'+A.defaultPreviewContent+"</div>"),A.$container.removeClass("file-input-new"),A._initClickable())},_resetPreviewThumbs:function(A){var t,e=this;return A?(e._clearPreview(),void e.clearStack()):void(e._hasInitialPreview()?(t=c.out(e.id),e.$preview.html(t.content),e._setCaption(t.caption),e._initPreviewActions()):e._clearPreview())},_getLayoutTemplate:function(A){var t=this,e=rA(A,t.layoutTemplates,Z[A]);return iA(t.customLayoutTags)?e:aA(e,t.customLayoutTags)},_getPreviewTemplate:function(A){var t=this,e=rA(A,t.previewTemplates,K[A]);return iA(t.customPreviewTags)?e:aA(e,t.customPreviewTags)},_getOutData:function(A,t,e){var i=this;return A=A||{},t=t||{},e=e||i.filestack.slice(0)||{},{form:i.formdata,files:e,filenames:i.filenames,filescount:i.getFilesCount(),extra:i._getExtraData(),response:t,reader:i.reader,jqXHR:A}},_getMsgSelected:function(A){var t=this,e=1===A?t.fileSingle:t.filePlural;return A>0?t.msgSelected.replace("{n}",A).replace("{files}",e):t.msgNoFilesSelected},_getThumbs:function(A){return A=A||"",this.$preview.find(".file-preview-frame:not(.file-preview-initial)"+A)},_getExtraData:function(A,t){var e=this,i=e.uploadExtraData;return"function"==typeof e.uploadExtraData&&(i=e.uploadExtraData(A,t)),i},_initXhr:function(A,t,e){var i=this;return A.upload&&A.upload.addEventListener("progress",function(A){var n=0,r=A.total,o=A.loaded||A.position;A.lengthComputable&&(n=Math.floor(o/r*100)),t?i._setAsyncUploadStatus(t,n,e):i._setProgress(n)},!1),A},_ajaxSubmit:function(t,e,i,n,r,o){var s,a=this;a._raise("filepreajax",[r,o]),a._uploadExtra(r,o),s=A.extend(!0,{},{xhr:function(){var t=A.ajaxSettings.xhr();return a._initXhr(t,r,a.getFileStack().length)},url:a.uploadUrl,type:"POST",dataType:"json",data:a.formdata,cache:!1,processData:!1,contentType:!1,beforeSend:t,success:e,complete:i,error:n},a.ajaxSettings),a.ajaxRequests.push(A.ajax(s))},_initUploadSuccess:function(t,e,i){var n,r,o,s,a,l,h,u,d=this,f=function(A,t){d[A]instanceof Array||(d[A]=[]),t&&t.length&&(d[A]=d[A].concat(t))};d.showPreview&&"object"==typeof t&&!A.isEmptyObject(t)&&void 0!==t.initialPreview&&t.initialPreview.length>0&&(d.hasInitData=!0,a=t.initialPreview||[],l=t.initialPreviewConfig||[],h=t.initialPreviewThumbTags||[],n=!(void 0!==t.append&&!t.append),a.length>0&&!nA(a)&&(a=a.split(d.initialPreviewDelimiter)),d.overwriteInitial=!1,f("initialPreview",a),f("initialPreviewConfig",l),f("initialPreviewThumbTags",h),void 0!==e?i?(u=e.attr("data-fileindex"),d.uploadCache.content[u]=a[0],d.uploadCache.config[u]=l[0]||[],d.uploadCache.tags[u]=h[0]||[],d.uploadCache.append=n):(o=c.add(d.id,a,l[0],h[0],n),r=c.get(d.id,o,!1),s=A(r).hide(),e.after(s).fadeOut("slow",function(){s.fadeIn("slow").css("display:inline-block"),d._initPreviewActions(),d._clearFileInput(),e.remove()})):(c.set(d.id,a,l,h,n),d._initPreview(),d._initPreviewActions()))},_initSuccessThumbs:function(){var t=this;t.showPreview&&t._getThumbs(".file-preview-success").each(function(){var e=A(this),i=e.find(".kv-file-remove");i.removeAttr("disabled"),l(i,"click",function(){var A=t._raise("filesuccessremove",[e.attr("id"),e.data("fileindex")]);lA(e),A!==!1&&e.fadeOut("slow",function(){e.remove(),t.$preview.find(".file-preview-frame").length||t.reset()})})})},_checkAsyncComplete:function(){var t,e,i=this;for(e=0;e<i.filestack.length;e++)if(i.filestack[e]&&(t=i.previewInitId+"-"+e,-1===A.inArray(t,i.uploadLog)))return!1;return i.uploadAsyncCount===i.uploadLog.length},_uploadExtra:function(t,e){var i=this,n=i._getExtraData(t,e);0!==n.length&&A.each(n,function(A,t){i.formdata.append(A,t)})},_uploadSingle:function(t,e,i){var n,r,o,s,a,l,h,u,d,f,p=this,B=p.getFileStack().length,w=new FormData,m=p.previewInitId+"-"+t,v=p.filestack.length>0||!A.isEmptyObject(p.uploadExtraData),E={id:m,index:t};p.formdata=w,p.showPreview&&(r=A("#"+m+":not(.file-preview-initial)"),s=r.find(".kv-file-upload"),a=r.find(".kv-file-remove"),A("#"+m).find(".file-thumb-progress").removeClass("hide")),0===B||!v||s&&s.hasClass("disabled")||p._abort(E)||(f=function(A,t){p.updateStack(A,void 0),p.uploadLog.push(t),p._checkAsyncComplete()&&(p.fileBatchCompleted=!0)},o=function(){var A=p.uploadCache;p.fileBatchCompleted&&setTimeout(function(){p.showPreview&&(c.set(p.id,A.content,A.config,A.tags,A.append),p.hasInitData&&(p._initPreview(),p._initPreviewActions())),p.unlock(),p._clearFileInput(),p._raise("filebatchuploadcomplete",[p.filestack,p._getExtraData()]),p.uploadCount=0,p.uploadStatus={},p.uploadLog=[],p._setProgress(101)},100)},l=function(e){n=p._getOutData(e),p.fileBatchCompleted=!1,p.showPreview&&(r.hasClass("file-preview-success")||(p._setThumbStatus(r,"Loading"),g(r,"file-uploading")),s.attr("disabled",!0),a.attr("disabled",!0)),i||p.lock(),p._raise("filepreupload",[n,m,t]),A.extend(!0,E,n),p._abort(E)&&(e.abort(),p._setProgressCancelled())},h=function(e,o,a){var l=p.showPreview&&r.attr("id")?r.attr("id"):m;n=p._getOutData(a,e),A.extend(!0,E,n),setTimeout(function(){iA(e)||iA(e.error)?(p.showPreview&&(p._setThumbStatus(r,"Success"),s.hide(),p._initUploadSuccess(e,r,i)),p._raise("fileuploaded",[n,l,t]),i?f(t,l):p.updateStack(t,void 0)):(p._showUploadError(e.error,E),p._setPreviewError(r,t),i&&f(t,l))},100)},u=function(){setTimeout(function(){p.showPreview&&(s.removeAttr("disabled"),a.removeAttr("disabled"),r.removeClass("file-uploading"),p._setProgress(101,A("#"+m).find(".file-thumb-progress"))),i?o():(p.unlock(!1),p._clearFileInput()),p._initSuccessThumbs()},100)},d=function(n,o,s){var a=p._parseError(n,s,i?e[t].name:null);setTimeout(function(){i&&f(t,m),p.uploadStatus[m]=100,p._setPreviewError(r,t),A.extend(!0,E,p._getOutData(n)),p._showUploadError(a,E)},100)},w.append(p.uploadFileAttr,e[t],p.filenames[t]),w.append("file_id",t),p._ajaxSubmit(l,h,u,d,m,t))},_uploadBatch:function(){var t,e,i,n,r,o=this,s=o.filestack,a=s.length,l={},c=o.filestack.length>0||!A.isEmptyObject(o.uploadExtraData);o.formdata=new FormData,0!==a&&c&&!o._abort(l)&&(r=function(){A.each(s,function(A){o.updateStack(A,void 0)}),o._clearFileInput()},t=function(t){o.lock();var e=o._getOutData(t);o.showPreview&&o._getThumbs().each(function(){var t=A(this),e=t.find(".kv-file-upload"),i=t.find(".kv-file-remove");t.hasClass("file-preview-success")||(o._setThumbStatus(t,"Loading"),g(t,"file-uploading")),e.attr("disabled",!0),i.attr("disabled",!0)}),o._raise("filebatchpreupload",[e]),o._abort(e)&&(t.abort(),o._setProgressCancelled())},e=function(t,e,i){var n=o._getOutData(i,t),s=o._getThumbs(":not(.file-preview-error)"),a=0,l=iA(t)||iA(t.errorkeys)?[]:t.errorkeys;iA(t)||iA(t.error)?(o._raise("filebatchuploadsuccess",[n]),r(),o.showPreview?(s.each(function(){var t=A(this),e=t.find(".kv-file-upload");t.find(".kv-file-upload").hide(),o._setThumbStatus(t,"Success"),t.removeClass("file-uploading"),e.removeAttr("disabled")}),o._initUploadSuccess(t)):o.reset()):(o.showPreview&&(s.each(function(){var t=A(this),e=t.find(".kv-file-remove"),i=t.find(".kv-file-upload");return t.removeClass("file-uploading"),i.removeAttr("disabled"),e.removeAttr("disabled"),0===l.length?void o._setPreviewError(t):(-1!==A.inArray(a,l)?o._setPreviewError(t):(t.find(".kv-file-upload").hide(),o._setThumbStatus(t,"Success"),o.updateStack(a,void 0)),void a++)}),o._initUploadSuccess(t)),o._showUploadError(t.error,n,"filebatchuploaderror"))},n=function(){o._setProgress(101),o.unlock(),o._initSuccessThumbs(),o._clearFileInput(),o._raise("filebatchuploadcomplete",[o.filestack,o._getExtraData()])},i=function(t,e,i){var n=o._getOutData(t),r=o._parseError(t,i);o._showUploadError(r,n,"filebatchuploaderror"),o.uploadFileCount=a-1,o.showPreview&&(o._getThumbs().each(function(){var t=A(this),e=t.attr("data-fileindex");t.removeClass("file-uploading"),void 0!==o.filestack[e]&&o._setPreviewError(t)}),o._getThumbs().removeClass("file-uploading"),o._getThumbs(" .kv-file-upload").removeAttr("disabled"),o._getThumbs(" .kv-file-delete").removeAttr("disabled"))},A.each(s,function(A,t){iA(s[A])||o.formdata.append(o.uploadFileAttr,t,o.filenames[A])}),o._ajaxSubmit(t,e,n,i))},_uploadExtraOnly:function(){var A,t,e,i,n=this,r={};n.formdata=new FormData,n._abort(r)||(A=function(A){n.lock();var t=n._getOutData(A);n._raise("filebatchpreupload",[t]),n._setProgress(50),r.data=t,r.xhr=A,n._abort(r)&&(A.abort(),n._setProgressCancelled())},t=function(A,t,e){var i=n._getOutData(e,A);iA(A)||iA(A.error)?(n._raise("filebatchuploadsuccess",[i]),n._clearFileInput(),n._initUploadSuccess(A)):n._showUploadError(A.error,i,"filebatchuploaderror")},e=function(){n._setProgress(101),n.unlock(),n._clearFileInput(),n._raise("filebatchuploadcomplete",[n.filestack,n._getExtraData()])},i=function(A,t,e){var i=n._getOutData(A),o=n._parseError(A,e);r.data=i,n._showUploadError(o,i,"filebatchuploaderror")},n._ajaxSubmit(A,t,e,i))},_initFileActions:function(){var t=this;t.showPreview&&(t._initZoomButton(),t.$preview.find(".kv-file-remove").each(function(){var e,i,n,r,o=A(this),s=o.closest(".file-preview-frame"),a=s.attr("id"),h=s.attr("data-fileindex");l(o,"click",function(){return r=t._raise("filepreremove",[a,h]),r!==!1&&t._validateMinCount()?(e=s.hasClass("file-preview-error"),lA(s),void s.fadeOut("slow",function(){t.updateStack(h,void 0),t._clearObjects(s),s.remove(),a&&e&&t.$errorContainer.find('li[data-file-id="'+a+'"]').fadeOut("fast",function(){A(this).remove(),t._errorsExist()||t._resetErrors()}),t._clearFileInput();var r=t.getFileStack(!0),o=c.count(t.id),l=r.length,u=t.showPreview&&t.$preview.find(".file-preview-frame").length;0!==l||0!==o||u?(i=o+l,n=i>1?t._getMsgSelected(i):r[0]?t._getFileNames()[0]:"",t._setCaption(n)):t.reset(),t._raise("fileremoved",[a,h])})):!1})}),t.$preview.find(".kv-file-upload").each(function(){var e=A(this);l(e,"click",function(){var A=e.closest(".file-preview-frame"),i=A.attr("data-fileindex");A.hasClass("file-preview-error")||t._uploadSingle(i,t.filestack,!1)})}))},_hideFileIcon:function(){this.overwriteInitial&&this.$captionContainer.find(".kv-caption-icon").hide()},_showFileIcon:function(){this.$captionContainer.find(".kv-caption-icon").show()},_getSize:function(A){var t=parseFloat(A);if(null===A||isNaN(t))return"";var e,i,n,r=this,o=r.fileSizeGetter;return"function"==typeof o?n=o(A):(e=Math.floor(Math.log(t)/Math.log(1024)),i=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],n=1*(t/Math.pow(1024,e)).toFixed(2)+" "+i[e]),r._getLayoutTemplate("size").replace("{sizeText}",n)},_generatePreviewTemplate:function(A,t,e,i,n,r,o,s,a,l){var c,h,u=this,d=u._getPreviewTemplate(A),f=s||"",g=rA(A,u.previewSettings,tA[A]),p=u.slug(e),B=a||u._renderFileFooter(p,o,g.width,r);return l=l||n.slice(n.lastIndexOf("-")+1),d=u._parseFilePreviewIcon(d,e),"text"===A||"html"===A?(h="text"===A?sA(t):t,c=d.replace(/\{previewId}/g,n).replace(/\{caption}/g,p).replace(/\{width}/g,g.width).replace(/\{height}/g,g.height).replace(/\{frameClass}/g,f).replace(/\{cat}/g,i).replace(/\{footer}/g,B).replace(/\{fileindex}/g,l).replace(/\{data}/g,h).replace(/\{template}/g,A)):c=d.replace(/\{previewId}/g,n).replace(/\{caption}/g,p).replace(/\{frameClass}/g,f).replace(/\{type}/g,i).replace(/\{fileindex}/g,l).replace(/\{width}/g,g.width).replace(/\{height}/g,g.height).replace(/\{footer}/g,B).replace(/\{data}/g,t).replace(/\{template}/g,A),c},_previewDefault:function(t,e,i){var n=this,r=n.$preview,s=r.find(".file-live-thumbs");if(n.showPreview){var a,l=t?t.name:"",c=t?t.type:"",h=i===!0&&!n.isUploadable,u=o.createObjectURL(t);n._clearDefaultPreview(),a=n._generatePreviewTemplate("other",u,l,c,e,h,t.size),s.length||(s=A(document.createElement("div")).addClass("file-live-thumbs").appendTo(r)),s.append("\n"+a),i===!0&&n.isUploadable&&n._setThumbStatus(A("#"+e),"Error")}},_previewFile:function(t,e,i,n,r){if(this.showPreview){var o,s=this,a=s._parseFileType(e),l=e?e.name:"",c=s.slug(l),h=s.allowedPreviewTypes,u=s.allowedPreviewMimeTypes,d=s.$preview,f=h&&h.indexOf(a)>=0,g=d.find(".file-live-thumbs"),p="text"===a||"html"===a||"image"===a?i.target.result:r,B=u&&-1!==u.indexOf(e.type);g.length||(g=A(document.createElement("div")).addClass("file-live-thumbs").appendTo(d)),"html"===a&&s.purifyHtml&&window.DOMPurify&&(p=window.DOMPurify.sanitize(p)),f||B?(o=s._generatePreviewTemplate(a,p,l,e.type,n,!1,e.size),s._clearDefaultPreview(),g.append("\n"+o),s._validateImage(t,n,c,e.type)):s._previewDefault(e,n),s._initSortable()}},_slugDefault:function(A){return iA(A)?"":String(A).replace(/[\-\[\]\/\{}:;#%=\(\)\*\+\?\\\^\$\|<>&"']/g,"_")},_readFiles:function(t){this.reader=new FileReader;var e,i=this,n=i.$element,r=i.$preview,a=i.reader,l=i.$previewContainer,c=i.$previewStatus,h=i.msgLoading,u=i.msgProgress,d=i.previewInitId,f=t.length,g=i.fileTypeSettings,p=i.filestack.length,B=i.maxFilePreviewSize&&parseFloat(i.maxFilePreviewSize),w=r.length&&(!B||isNaN(B)),m=function(n,r,o,s){var a=A.extend(!0,{},i._getOutData({},{},t),{id:o,index:s}),l={id:o,index:s,file:r,files:t};return i._previewDefault(r,o,!0),i.isUploadable&&i.addToStack(void 0),setTimeout(function(){e(s+1)},100),i._initFileActions(),i.removeFromPreviewOnError&&A("#"+o).remove(),i.isUploadable?i._showUploadError(n,a):i._showError(n,l)};i.loadedImages=[],i.totalImagesCount=0,A.each(t,function(A,t){var e=i.fileTypeSettings.image||eA.image;e&&e(t.type)&&i.totalImagesCount++}),e=function(A){if(iA(n.attr("multiple"))&&(f=1),A>=f)return i.isUploadable&&i.filestack.length>0?i._raise("filebatchselected",[i.getFileStack()]):i._raise("filebatchselected",[t]),l.removeClass("file-thumb-loading"),void c.html("");var v,E,b,I,Q,C,D,y=p+A,M=d+"-"+y,F=t[A],x=i.slug(F.name),T=(F.size||0)/1e3,P="",S=o.createObjectURL(F),k=0,Y=i.allowedFileTypes,U=iA(Y)?"":Y.join(", "),N=i.allowedFileExtensions,H=iA(N)?"":N.join(", ");if(iA(N)||(P=new RegExp("\\.("+N.join("|")+")$","i")),T=T.toFixed(2),i.maxFileSize>0&&T>i.maxFileSize)return Q=i.msgSizeTooLarge.replace("{name}",x).replace("{size}",T).replace("{maxSize}",i.maxFileSize),void(i.isError=m(Q,F,M,A));if(!iA(Y)&&nA(Y)){for(I=0;I<Y.length;I+=1)C=Y[I],b=g[C],D=void 0!==b&&b(F.type,x),k+=iA(D)?0:D.length;if(0===k)return Q=i.msgInvalidFileType.replace("{name}",x).replace("{types}",U),void(i.isError=m(Q,F,M,A))}return 0!==k||iA(N)||!nA(N)||iA(P)||(D=s(x,P),k+=iA(D)?0:D.length,0!==k)?i.showPreview?!w&&T>B?(i.addToStack(F),l.addClass("file-thumb-loading"),i._previewDefault(F,M),i._initFileActions(),i._updateFileDetails(f),void e(A+1)):(r.length&&void 0!==FileReader?(c.html(h.replace("{index}",A+1).replace("{files}",f)),l.addClass("file-thumb-loading"),a.onerror=function(A){i._errorHandler(A,x)},a.onload=function(t){i._previewFile(A,F,t,M,S),i._initFileActions()},a.onloadend=function(){Q=u.replace("{index}",A+1).replace("{files}",f).replace("{percent}",50).replace("{name}",x),setTimeout(function(){c.html(Q),i._updateFileDetails(f),e(A+1)},100),i._raise("fileloaded",[F,M,A,a])},a.onprogress=function(t){if(t.lengthComputable){var e=t.loaded/t.total*100,i=Math.ceil(e);Q=u.replace("{index}",A+1).replace("{files}",f).replace("{percent}",i).replace("{name}",x),setTimeout(function(){c.html(Q)},100)}},v=rA("text",g,eA.text),E=rA("image",g,eA.image),v(F.type,x)?a.readAsText(F,i.textEncoding):E(F.type,x)?a.readAsDataURL(F):a.readAsArrayBuffer(F)):(i._previewDefault(F,M),setTimeout(function(){e(A+1),i._updateFileDetails(f)},100),i._raise("fileloaded",[F,M,A,a])),void i.addToStack(F)):(i.addToStack(F),setTimeout(function(){e(A+1)},100),void i._raise("fileloaded",[F,M,A,a])):(Q=i.msgInvalidFileExtension.replace("{name}",x).replace("{extensions}",H),void(i.isError=m(Q,F,M,A)))},e(0),i._updateFileDetails(f,!1)},_updateFileDetails:function(A){var t=this,e=t.$element,i=t.getFileStack(),n=a(9)&&cA(e.val())||e[0].files[0]&&e[0].files[0].name||i.length&&i[0].name||"",r=t.slug(n),o=t.isUploadable?i.length:A,s=c.count(t.id)+o,l=o>1?t._getMsgSelected(s):r;t.isError?(t.$previewContainer.removeClass("file-thumb-loading"),t.$previewStatus.html(""),t.$captionContainer.find(".kv-caption-icon").hide()):t._showFileIcon(),t._setCaption(l,t.isError),t.$container.removeClass("file-input-new file-input-ajax-new"),1===arguments.length&&t._raise("fileselect",[A,r]),c.count(t.id)&&t._initPreviewActions()},_setThumbStatus:function(A,t){var e=this;if(e.showPreview){var i="indicator"+t,n=i+"Title",r="file-preview-"+t.toLowerCase(),o=A.find(".file-upload-indicator"),s=e.fileActionSettings;A.removeClass("file-preview-success file-preview-error file-preview-loading"),"Error"===t&&A.find(".kv-file-upload").attr("disabled",!0),"Success"===t&&(A.find(".file-drag-handle").remove(),o.css("margin-left",0)),o.html(s[i]),o.attr("title",s[n]),A.addClass(r)}},_setProgressCancelled:function(){var A=this;A._setProgress(101,A.$progress,A.msgCancelled)},_setProgress:function(A,t,e){var i=this,n=Math.min(A,100),r=100>n?i.progressTemplate:e?i.progressErrorTemplate:100>=A?i.progressTemplate:i.progressCompleteTemplate,o=i.progressUploadThreshold;if(t=t||i.$progress,!iA(r)){if(o&&n>o&&100>=A){var s=r.replace("{percent}",o).replace("{percent}",o).replace("{percent}%",i.msgUploadThreshold);t.html(s)}else t.html(r.replace(/\{percent}/g,n));e&&t.find('[role="progressbar"]').html(e)}},_setFileDropZoneTitle:function(){var A,t=this,e=t.$container.find(".file-drop-zone"),i=t.dropZoneTitle;t.isClickable&&(A=iA(t.$element.attr("multiple"))?t.fileSingle:t.filePlural,i+=t.dropZoneClickTitle.replace("{files}",A)),e.find("."+t.dropZoneTitleClass).remove(),t.isUploadable&&t.showPreview&&0!==e.length&&!(t.getFileStack().length>0)&&t.dropZoneEnabled&&(0===e.find(".file-preview-frame").length&&iA(t.defaultPreviewContent)&&e.prepend('<div class="'+t.dropZoneTitleClass+'">'+i+"</div>"),t.$container.removeClass("file-input-new"),g(t.$container,"file-input-ajax-new"))},_setAsyncUploadStatus:function(t,e,i){var n=this,r=0;n._setProgress(e,A("#"+t).find(".file-thumb-progress")),n.uploadStatus[t]=e,A.each(n.uploadStatus,function(A,t){r+=t}),n._setProgress(Math.floor(r/i))},_validateMinCount:function(){var A=this,t=A.isUploadable?A.getFileStack().length:A.$element.get(0).files.length;return A.validateInitialCount&&A.minFileCount>0&&A._getFileCount(t-1)<A.minFileCount?(A._noFilesError({}),!1):!0},_getFileCount:function(A){var t=this,e=0;return t.validateInitialCount&&!t.overwriteInitial&&(e=c.count(t.id),A+=e),A},_getFileName:function(A){return A&&A.name?this.slug(A.name):void 0},_getFileNames:function(A){var t=this;return t.filenames.filter(function(t){return A?void 0!==t:void 0!==t&&null!==t})},_setPreviewError:function(A,t,e){var i=this;void 0!==t&&i.updateStack(t,e),i.removeFromPreviewOnError?A.remove():i._setThumbStatus(A,"Error")},_checkDimensions:function(A,t,e,i,n,r,o){var s,a,l,c,h=this,u="Small"===t?"min":"max",d=h[u+"Image"+r];!iA(d)&&e.length&&(l=e[0],a="Width"===r?l.naturalWidth||l.width:l.naturalHeight||l.height,c="Small"===t?a>=d:d>=a,c||(s=h["msgImage"+r+t].replace("{name}",n).replace("{size}",d),h._showUploadError(s,o),h._setPreviewError(i,A,null)))},_validateImage:function(A,t,e,i){var n,r,s,a=this,c=a.$preview,h=c.find("#"+t),u=h.find("img");e=e||"Untitled",u.length&&l(u,"load",function(){r=h.width(),s=c.width(),r>s&&(u.css("width","100%"),h.css("width","97%")),n={ind:A,id:t},a._checkDimensions(A,"Small",u,h,e,"Width",n),a._checkDimensions(A,"Small",u,h,e,"Height",n),a.resizeImage||(a._checkDimensions(A,"Large",u,h,e,"Width",n),a._checkDimensions(A,"Large",u,h,e,"Height",n)),a._raise("fileimageloaded",[t]),a.loadedImages.push({ind:A,img:u,thumb:h,pid:t,typ:i}),a._validateAllImages(),o.revokeObjectURL(u.attr("src"))})},_validateAllImages:function(){var A,t,e,i,n,r,o,s=this,a={};if(s.loadedImages.length===s.totalImagesCount&&(s._raise("fileimagesloaded"),s.resizeImage)){for(o=s.isUploadable?s._showUploadError:s._showError,A=0;A<s.loadedImages.length;A++)t=s.loadedImages[A],e=t.img,i=t.thumb,n=t.pid,r=t.ind,a={id:n,index:r},s._getResizedImage(e[0],t.typ,n,r)||(o(s.msgImageResizeError,a,"fileimageresizeerror"),s._setPreviewError(i,r));s._raise("fileimagesresized")}},_getResizedImage:function(A,t,e,i){var n,r,o=this,s=A.naturalWidth,a=A.naturalHeight,l=1,c=o.maxImageWidth||s,h=o.maxImageHeight||a,u=s&&a,d=o.imageCanvas,f=o.imageCanvasContext;if(!u)return!1;if(s===c&&a===h)return!0;t=t||o.resizeDefaultImageType,n=s>c,r=a>h,l="width"===o.resizePreference?n?c/s:r?h/a:1:r?h/a:n?c/s:1,o._resetCanvas(),s*=l,a*=l,d.width=s,d.height=a;try{return f.drawImage(A,0,0,s,a),d.toBlob(function(A){o._raise("fileimageresized",[e,i]),o.filestack[i]=A},t,o.resizeQuality),!0}catch(g){return!1}},_initBrowse:function(A){var t=this;t.showBrowse?(t.$btnFile=A.find(".btn-file"),t.$btnFile.append(t.$element)):t.$element.hide()},_initCaption:function(){var A=this,t=A.initialCaption||"";return A.overwriteInitial||iA(t)?(A.$caption.html(""),!1):(A._setCaption(t),!0)},_setCaption:function(t,e){var i,n,r,o,s=this,a=s.getFileStack();if(s.$caption.length){if(e)i=A("<div>"+s.msgValidationError+"</div>").text(),r=a.length,o=r?1===r&&a[0]?s._getFileNames()[0]:s._getMsgSelected(r):s._getMsgSelected(s.msgNo),n='<span class="'+s.msgValidationErrorClass+'">'+s.msgValidationErrorIcon+(iA(t)?o:t)+"</span>";else{if(iA(t))return;i=A("<div>"+t+"</div>").text(),n=s._getLayoutTemplate("fileIcon")+i}s.$caption.html(n),s.$caption.attr("title",i),s.$captionContainer.find(".file-caption-ellipsis").attr("title",i)}},_createContainer:function(){var t=this,e=A(document.createElement("div")).attr({"class":"file-input file-input-new"}).html(t._renderMain());return t.$element.before(e),t._initBrowse(e),t.theme&&e.addClass("theme-"+t.theme),e},_refreshContainer:function(){var A=this,t=A.$container;t.before(A.$element),t.html(A._renderMain()),A._initBrowse(t)},_renderMain:function(){var A=this,t=A.isUploadable&&A.dropZoneEnabled?" file-drop-zone":"file-drop-disabled",e=A.showClose?A._getLayoutTemplate("close"):"",i=A.showPreview?A._getLayoutTemplate("preview").replace(/\{class}/g,A.previewClass).replace(/\{dropClass}/g,t):"",n=A.isDisabled?A.captionClass+" file-caption-disabled":A.captionClass,r=A.captionTemplate.replace(/\{class}/g,n+" kv-fileinput-caption");return A.mainTemplate.replace(/\{class}/g,A.mainClass+(!A.showBrowse&&A.showCaption?" no-browse":"")).replace(/\{preview}/g,i).replace(/\{close}/g,e).replace(/\{caption}/g,r).replace(/\{upload}/g,A._renderButton("upload")).replace(/\{remove}/g,A._renderButton("remove")).replace(/\{cancel}/g,A._renderButton("cancel")).replace(/\{browse}/g,A._renderButton("browse"))},_renderButton:function(A){var t=this,e=t._getLayoutTemplate("btnDefault"),i=t[A+"Class"],n=t[A+"Title"],r=t[A+"Icon"],o=t[A+"Label"],s=t.isDisabled?" disabled":"",a="button";switch(A){case"remove":if(!t.showRemove)return"";break;case"cancel":if(!t.showCancel)return"";i+=" hide";break;case"upload":if(!t.showUpload)return"";t.isUploadable&&!t.isDisabled?e=t._getLayoutTemplate("btnLink").replace("{href}",t.uploadUrl):a="submit";break;case"browse":if(!t.showBrowse)return"";e=t._getLayoutTemplate("btnBrowse");break;default:return""}return i+="browse"===A?" btn-file":" fileinput-"+A+" fileinput-"+A+"-button",iA(o)||(o=' <span class="'+t.buttonLabelClass+'">'+o+"</span>"),e.replace("{type}",a).replace("{css}",i).replace("{title}",n).replace("{status}",s).replace("{icon}",r).replace("{label}",o)},_renderThumbProgress:function(){return'<div class="file-thumb-progress hide">'+this.progressTemplate.replace(/\{percent}/g,"0")+"</div>"},_renderFileFooter:function(A,t,e,i){var n,r=this,o=r.fileActionSettings,s=o.showRemove,a=o.showDrag,l=o.showUpload,c=o.showZoom,h=r._getLayoutTemplate("footer"),u=i?o.indicatorError:o.indicatorNew,d=i?o.indicatorErrorTitle:o.indicatorNewTitle;return t=r._getSize(t),n=r.isUploadable?h.replace(/\{actions}/g,r._renderFileActions(l,s,c,a,!1,!1,!1)).replace(/\{caption}/g,A).replace(/\{size}/g,t).replace(/\{width}/g,e).replace(/\{progress}/g,r._renderThumbProgress()).replace(/\{indicator}/g,u).replace(/\{indicatorTitle}/g,d):h.replace(/\{actions}/g,r._renderFileActions(!1,!1,c,a,!1,!1,!1)).replace(/\{caption}/g,A).replace(/\{size}/g,t).replace(/\{width}/g,e).replace(/\{progress}/g,"").replace(/\{indicator}/g,u).replace(/\{indicatorTitle}/g,d),n=aA(n,r.previewThumbTags)},_renderFileActions:function(A,t,e,i,n,r,o,s){if(!(A||t||e||i))return"";var a,l=this,c=r===!1?"":' data-url="'+r+'"',h=o===!1?"":' data-key="'+o+'"',u="",d="",f="",g="",p=l._getLayoutTemplate("actions"),B=l.fileActionSettings,w=l.otherActionButtons.replace(/\{dataKey}/g,h),m=n?B.removeClass+" disabled":B.removeClass;return t&&(u=l._getLayoutTemplate("actionDelete").replace(/\{removeClass}/g,m).replace(/\{removeIcon}/g,B.removeIcon).replace(/\{removeTitle}/g,B.removeTitle).replace(/\{dataUrl}/g,c).replace(/\{dataKey}/g,h)),A&&(d=l._getLayoutTemplate("actionUpload").replace(/\{uploadClass}/g,B.uploadClass).replace(/\{uploadIcon}/g,B.uploadIcon).replace(/\{uploadTitle}/g,B.uploadTitle)),e&&(f=l._getLayoutTemplate("actionZoom").replace(/\{zoomClass}/g,B.zoomClass).replace(/\{zoomIcon}/g,B.zoomIcon).replace(/\{zoomTitle}/g,B.zoomTitle)),i&&s&&(a="drag-handle-init "+B.dragClass,g=l._getLayoutTemplate("actionDrag").replace(/\{dragClass}/g,a).replace(/\{dragTitle}/g,B.dragTitle).replace(/\{dragIcon}/g,B.dragIcon)),p.replace(/\{delete}/g,u).replace(/\{upload}/g,d).replace(/\{zoom}/g,f).replace(/\{drag}/g,g).replace(/\{other}/g,w)},_browse:function(A){var t=this;t._raise("filebrowse"),A&&A.isDefaultPrevented()||(t.isError&&!t.isUploadable&&t.clear(),t.$captionContainer.focus())},_change:function(t){var e=this,i=e.$element;if(!e.isUploadable&&iA(i.val())&&e.fileInputCleared)return void(e.fileInputCleared=!1);e.fileInputCleared=!1;var n,r,o,s,a,l,h=arguments.length>1,u=e.isUploadable,d=0,f=h?t.originalEvent.dataTransfer.files:i.get(0).files,g=e.filestack.length,p=iA(i.attr("multiple")),B=p&&g>0,w=0,m=function(t,i,n,r){var o=A.extend(!0,{},e._getOutData({},{},f),{id:n,index:r}),s={id:n,index:r,file:i,files:f};return e.isUploadable?e._showUploadError(t,o):e._showError(t,s)};if(e.reader=null,e._resetUpload(),e._hideFileIcon(),e.isUploadable&&e.$container.find(".file-drop-zone ."+e.dropZoneTitleClass).remove(),h)for(n=[];f[d];)s=f[d],s.type||s.size%4096!==0?n.push(s):w++,d++;else n=void 0===t.target.files?t.target&&t.target.value?[{name:t.target.value.replace(/^.+\\/,"")}]:[]:t.target.files;if(iA(n)||0===n.length)return u||e.clear(),e._showFolderError(w),void e._raise("fileselectnone");if(e._resetErrors(),l=n.length,o=e._getFileCount(e.isUploadable?e.getFileStack().length+l:l),e.maxFileCount>0&&o>e.maxFileCount){if(!e.autoReplace||l>e.maxFileCount)return a=e.autoReplace&&l>e.maxFileCount?l:o,r=e.msgFilesTooMany.replace("{m}",e.maxFileCount).replace("{n}",a),e.isError=m(r,null,null,null),e.$captionContainer.find(".kv-caption-icon").hide(),e._setCaption("",!0),void e.$container.removeClass("file-input-new file-input-ajax-new");o>e.maxFileCount&&e._resetPreviewThumbs(u)}else!u||B?(e._resetPreviewThumbs(!1),B&&e.clearStack()):!u||0!==g||c.count(e.id)&&!e.overwriteInitial||e._resetPreviewThumbs(!0);e.isPreviewable?e._readFiles(n):e._updateFileDetails(1),e._showFolderError(w)},_abort:function(t){var e,i=this;return i.ajaxAborted&&"object"==typeof i.ajaxAborted&&void 0!==i.ajaxAborted.message?(e=A.extend(!0,{},i._getOutData(),t),e.abortData=i.ajaxAborted.data||{},e.abortMessage=i.ajaxAborted.message,i.cancel(),i._setProgress(101,i.$progress,i.msgCancelled),i._showUploadError(i.ajaxAborted.message,e,"filecustomerror"),!0):!1},_resetFileStack:function(){var t=this,e=0,i=[],n=[];t._getThumbs().each(function(){var r=A(this),o=r.attr("data-fileindex"),s=t.filestack[o];-1!==o&&(void 0!==s?(i[e]=s,n[e]=t._getFileName(s),r.attr({id:t.previewInitId+"-"+e,"data-fileindex":e}),e++):r.attr({id:"uploaded-"+oA(),"data-fileindex":"-1"}))}),t.filestack=i,t.filenames=n},clearStack:function(){var A=this;return A.filestack=[],A.filenames=[],A.$element},updateStack:function(A,t){var e=this;return e.filestack[A]=t,e.filenames[A]=e._getFileName(t),e.$element},addToStack:function(A){var t=this;return t.filestack.push(A),t.filenames.push(t._getFileName(A)),t.$element},getFileStack:function(A){var t=this;return t.filestack.filter(function(t){return A?void 0!==t:void 0!==t&&null!==t})},getFilesCount:function(){var A=this,t=A.isUploadable?A.getFileStack().length:A.$element.get(0).files.length;return A._getFileCount(t)},lock:function(){var A=this;return A._resetErrors(),A.disable(),A.showRemove&&g(A.$container.find(".fileinput-remove"),"hide"),A.showCancel&&A.$container.find(".fileinput-cancel").removeClass("hide"),A._raise("filelock",[A.filestack,A._getExtraData()]),A.$element},unlock:function(A){var t=this;return void 0===A&&(A=!0),t.enable(),t.showCancel&&g(t.$container.find(".fileinput-cancel"),"hide"),t.showRemove&&t.$container.find(".fileinput-remove").removeClass("hide"),A&&t._resetFileStack(),t._raise("fileunlock",[t.filestack,t._getExtraData()]),t.$element},cancel:function(){var t,e=this,i=e.ajaxRequests,n=i.length;if(n>0)for(t=0;n>t;t+=1)e.cancelling=!0,i[t].abort();return e._setProgressCancelled(),e._getThumbs().each(function(){var t=A(this),i=t.attr("data-fileindex");t.removeClass("file-uploading"),void 0!==e.filestack[i]&&(t.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled"),t.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled")),e.unlock()}),e.$element},clear:function(){var t,e=this;return e.$btnUpload.removeAttr("disabled"),e._getThumbs().find("video,audio,img").each(function(){lA(A(this))}),e._resetUpload(),e.clearStack(),e._clearFileInput(),e._resetErrors(!0),e._raise("fileclear"),e._hasInitialPreview()?(e._showFileIcon(),e._resetPreview(),e._initPreviewActions(),e.$container.removeClass("file-input-new")):(e._getThumbs().each(function(){e._clearObjects(A(this))}),e.isUploadable&&(c.data[e.id]={}),e.$preview.html(""),t=!e.overwriteInitial&&e.initialCaption.length>0?e.initialCaption:"",e.$caption.html(t),e.$caption.attr("title",""),g(e.$container,"file-input-new"),e._validateDefaultPreview()),0===e.$container.find(".file-preview-frame").length&&(e._initCaption()||e.$captionContainer.find(".kv-caption-icon").hide()),e._hideFileIcon(),e._raise("filecleared"),e.$captionContainer.focus(),e._setFileDropZoneTitle(),e.$element},reset:function(){var A=this;return A._resetPreview(),A.$container.find(".fileinput-filename").text(""),A._raise("filereset"),g(A.$container,"file-input-new"),(A.$preview.find(".file-preview-frame").length||A.isUploadable&&A.dropZoneEnabled)&&A.$container.removeClass("file-input-new"),A._setFileDropZoneTitle(),A.clearStack(),A.formdata={},A.$element},disable:function(){var A=this;return A.isDisabled=!0,A._raise("filedisabled"),A.$element.attr("disabled","disabled"),A.$container.find(".kv-fileinput-caption").addClass("file-caption-disabled"),A.$container.find(".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button").attr("disabled",!0),A._initDragDrop(),A.$element},enable:function(){var A=this;return A.isDisabled=!1,A._raise("fileenabled"),A.$element.removeAttr("disabled"),A.$container.find(".kv-fileinput-caption").removeClass("file-caption-disabled"),A.$container.find(".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button").removeAttr("disabled"),A._initDragDrop(),A.$element},upload:function(){var t,e,i,n=this,r=n.getFileStack().length,o={},s=!A.isEmptyObject(n._getExtraData());if(n.minFileCount>0&&n._getFileCount(r)<n.minFileCount)return void n._noFilesError(o);if(n.isUploadable&&!n.isDisabled&&(0!==r||s)){if(n._resetUpload(),n.$progress.removeClass("hide"),n.uploadCount=0,n.uploadStatus={},n.uploadLog=[],n.lock(),n._setProgress(2),0===r&&s)return void n._uploadExtraOnly();if(i=n.filestack.length,n.hasInitData=!1,!n.uploadAsync)return n._uploadBatch(),n.$element;for(e=n._getOutData(),n._raise("filebatchpreupload",[e]),n.fileBatchCompleted=!1,n.uploadCache={content:[],config:[],tags:[],append:!0},n.uploadAsyncCount=n.getFileStack().length,t=0;i>t;t++)n.uploadCache.content[t]=null,
n.uploadCache.config[t]=null,n.uploadCache.tags[t]=null;for(t=0;i>t;t++)void 0!==n.filestack[t]&&n._uploadSingle(t,n.filestack,!0)}},destroy:function(){var A=this,e=A.$container;return e.find(".file-drop-zone").off(),A.$element.insertBefore(e).off(t).removeData(),e.off().remove(),A.$element},refresh:function(t){var e=this,i=e.$element;return t=t?A.extend(!0,{},e.options,t):e.options,e.destroy(),i.fileinput(t),i.val()&&i.trigger("change.fileinput"),i}},A.fn.fileinput=function(t){if(u()||a(9)){var e=Array.apply(null,arguments),i=[];switch(e.shift(),this.each(function(){var n,r=A(this),o=r.data("fileinput"),s="object"==typeof t&&t,a=s.theme||r.data("theme"),l={},c={},h=s.language||r.data("language")||"en";o||(a&&(c=A.fn.fileinputThemes[a]||{}),"en"===h||iA(A.fn.fileinputLocales[h])||(l=A.fn.fileinputLocales[h]||{}),n=A.extend(!0,{},A.fn.fileinput.defaults,c,A.fn.fileinputLocales.en,l,s,r.data()),o=new fA(this,n),r.data("fileinput",o)),"string"==typeof t&&i.push(o[t].apply(o,e))}),i.length){case 0:return this;case 1:return i[0];default:return i}}},A.fn.fileinput.defaults={language:"en",showCaption:!0,showBrowse:!0,showPreview:!0,showRemove:!0,showUpload:!0,showCancel:!0,showClose:!0,showUploadedThumbs:!0,browseOnZoneClick:!1,autoReplace:!1,previewClass:"",captionClass:"",mainClass:"file-caption-main",mainTemplate:null,purifyHtml:!0,fileSizeGetter:null,initialCaption:"",initialPreview:[],initialPreviewDelimiter:"*$$*",initialPreviewAsData:!1,initialPreviewFileType:"image",initialPreviewConfig:[],initialPreviewThumbTags:[],previewThumbTags:{},initialPreviewShowDelete:!0,removeFromPreviewOnError:!1,deleteUrl:"",deleteExtraData:{},overwriteInitial:!0,layoutTemplates:Z,previewTemplates:K,previewZoomSettings:q,previewZoomButtonIcons:{prev:'<i class="glyphicon glyphicon-triangle-left"></i>',next:'<i class="glyphicon glyphicon-triangle-right"></i>',toggleheader:'<i class="glyphicon glyphicon-resize-vertical"></i>',fullscreen:'<i class="glyphicon glyphicon-fullscreen"></i>',borderless:'<i class="glyphicon glyphicon-resize-full"></i>',close:'<i class="glyphicon glyphicon-remove"></i>'},previewZoomButtonClasses:{prev:"btn btn-navigate",next:"btn btn-navigate",toggleheader:"btn btn-default btn-header-toggle",fullscreen:"btn btn-default",borderless:"btn btn-default",close:"btn btn-default"},allowedPreviewTypes:$,allowedPreviewMimeTypes:null,allowedFileTypes:null,allowedFileExtensions:null,defaultPreviewContent:null,customLayoutTags:{},customPreviewTags:{},previewSettings:tA,fileTypeSettings:eA,previewFileIcon:'<i class="glyphicon glyphicon-file"></i>',previewFileIconClass:"file-other-icon",previewFileIconSettings:{},previewFileExtSettings:{},buttonLabelClass:"hidden-xs",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i>&nbsp;',browseClass:"btn btn-primary",removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-default",cancelIcon:'<i class="glyphicon glyphicon-ban-circle"></i>',cancelClass:"btn btn-default",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-default",uploadUrl:null,uploadAsync:!0,uploadExtraData:{},zoomModalHeight:480,minImageWidth:null,minImageHeight:null,maxImageWidth:null,maxImageHeight:null,resizeImage:!1,resizePreference:"width",resizeQuality:.92,resizeDefaultImageType:"image/jpeg",maxFileSize:0,maxFilePreviewSize:25600,minFileCount:0,maxFileCount:0,validateInitialCount:!1,msgValidationErrorClass:"text-danger",msgValidationErrorIcon:'<i class="glyphicon glyphicon-exclamation-sign"></i> ',msgErrorClass:"file-error-message",progressThumbClass:"progress-bar progress-bar-success progress-bar-striped active",progressClass:"progress-bar progress-bar-success progress-bar-striped active",progressCompleteClass:"progress-bar progress-bar-success",progressErrorClass:"progress-bar progress-bar-danger",progressUploadThreshold:99,previewFileType:"image",elCaptionContainer:null,elCaptionText:null,elPreviewContainer:null,elPreviewImage:null,elPreviewStatus:null,elErrorContainer:null,errorCloseButton:'<span class="close kv-error-close">&times;</span>',slugCallback:null,dropZoneEnabled:!0,dropZoneTitleClass:"file-drop-zone-title",fileActionSettings:{},otherActionButtons:"",textEncoding:"UTF-8",ajaxSettings:{},ajaxDeleteSettings:{},showAjaxErrorDetails:!0},A.fn.fileinputLocales.en={fileSingle:"file",filePlural:"files",browseLabel:"Browse &hellip;",removeLabel:"Remove",removeTitle:"Clear selected files",cancelLabel:"Cancel",cancelTitle:"Abort ongoing upload",uploadLabel:"Upload",uploadTitle:"Upload selected files",msgNo:"No",msgNoFilesSelected:"No files selected",msgCancelled:"Cancelled",msgZoomModalHeading:"Detailed Preview",msgSizeTooLarge:'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',msgFilesTooLess:"You must select at least <b>{n}</b> {files} to upload.",msgFilesTooMany:"Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.",msgFileNotFound:'File "{name}" not found!',msgFileSecured:'Security restrictions prevent reading the file "{name}".',msgFileNotReadable:'File "{name}" is not readable.',msgFilePreviewAborted:'File preview aborted for "{name}".',msgFilePreviewError:'An error occurred while reading the file "{name}".',msgInvalidFileType:'Invalid type for file "{name}". Only "{types}" files are supported.',msgInvalidFileExtension:'Invalid extension for file "{name}". Only "{extensions}" files are supported.',msgUploadAborted:"The file upload was aborted",msgUploadThreshold:"Processing...",msgValidationError:"Validation Error",msgLoading:"Loading file {index} of {files} &hellip;",msgProgress:"Loading file {index} of {files} - {name} - {percent}% completed.",msgSelected:"{n} {files} selected",msgFoldersNotAllowed:"Drag & drop files only! {n} folder(s) dropped were skipped.",msgImageWidthSmall:'Width of image file "{name}" must be at least {size} px.',msgImageHeightSmall:'Height of image file "{name}" must be at least {size} px.',msgImageWidthLarge:'Width of image file "{name}" cannot exceed {size} px.',msgImageHeightLarge:'Height of image file "{name}" cannot exceed {size} px.',msgImageResizeError:"Could not get the image dimensions to resize.",msgImageResizeException:"Error while resizing the image.<pre>{errors}</pre>",dropZoneTitle:"Drag & drop files here &hellip;",dropZoneClickTitle:"<br>(or click to select {files})",previewZoomButtonTitles:{prev:"View previous file",next:"View next file",toggleheader:"Toggle header",fullscreen:"Toggle full screen",borderless:"Toggle borderless mode",close:"Close detailed preview"}},A.fn.fileinput.Constructor=fA,A(document).ready(function(){var t=A("input.file[type=file]");t.length&&t.fileinput()})});